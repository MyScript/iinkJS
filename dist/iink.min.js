!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e=e||self).iink={})}(this,(function(e){"use strict";var t={EventType:{IDLE:"idle",CHANGED:"changed",IMPORTED:"imported",EXPORTED:"exported",CONVERTED:"converted",RENDERED:"rendered",LOADED:"loaded",UNDO:"undo",REDO:"redo",CLEAR:"clear",IMPORT:"import",SUPPORTED_IMPORT_MIMETYPES:"supportedImportMimeTypes",EXPORT:"export",CONVERT:"convert",ERROR:"error"},RecognitionType:{TEXT:"TEXT",MATH:"MATH",DIAGRAM:"DIAGRAM",RAWCONTENT:"Raw Content"},Protocol:{WEBSOCKET:"WEBSOCKET",REST:"REST"},ModelState:{INITIALIZING:"INITIALIZING",INITIALIZED:"INITIALIZED",EXPORTING:"EXPORTING",EXPORTED:"EXPORTED",PENDING:"PENDING",MODIFIED:"MODIFIED",ERROR:"ERROR"},Trigger:{QUIET_PERIOD:"QUIET_PERIOD",POINTER_UP:"POINTER_UP",DEMAND:"DEMAND"},Logger:{EDITOR:"editor",MODEL:"model",GRABBER:"grabber",RENDERER:"renderer",RECOGNIZER:"recognizer",EVENT:"event",UTIL:"util",SMARTGUIDE:"smartguide"},LogLevel:{TRACE:"TRACE",DEBUG:"DEBUG",INFO:"INFO",WARN:"WARN",ERROR:"ERROR"},Languages:{zh_CN:"Noto Sans CJK tc",zh_HK:"Noto Sans CJK tc",zh_TW:"Noto Sans CJK tc",ko_KR:"Noto Sans CJK kr",ja_JP:"Noto Sans CJK jp",hy_AM:"Noto Sans Armenian",default:"Open Sans"},Error:{NOT_REACHABLE:"MyScript recognition server is not reachable. Please reload once you are connected.",WRONG_CREDENTIALS:"Application credentials are invalid. Please check or regenerate your application key and hmackey.",TOO_OLD:"Session is too old. Max Session Duration Reached."},Exports:{JIIX:"application/vnd.myscript.jiix"}},n="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function r(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function o(e,t){return e(t={exports:{}},t.exports),t.exports}var i=(0,o((function(e){!function(t,n){e.exports?e.exports=n():t.log=n()}(n,(function(){var e=function(){},t="undefined"!=typeof window&&void 0!==window.navigator&&/Trident\/|MSIE /.test(window.navigator.userAgent),n=["trace","debug","info","warn","error"];function r(e,t){var n=e[t];if("function"==typeof n.bind)return n.bind(e);try{return Function.prototype.bind.call(n,e)}catch(t){return function(){return Function.prototype.apply.apply(n,[e,arguments])}}}function o(){console.log&&(console.log.apply?console.log.apply(console,arguments):Function.prototype.apply.apply(console.log,[console,arguments])),console.trace&&console.trace()}function i(n){return"debug"===n&&(n="log"),"undefined"!=typeof console&&("trace"===n&&t?o:void 0!==console[n]?r(console,n):void 0!==console.log?r(console,"log"):e)}function a(t,r){for(var o=0;o<n.length;o++){var i=n[o];this[i]=o<t?e:this.methodFactory(i,t,r)}this.log=this.debug}function s(e,t,n){return function(){"undefined"!=typeof console&&(a.call(this,t,n),this[e].apply(this,arguments))}}function c(e,t,n){return i(e)||s.apply(this,arguments)}function l(e,t,r){var o,i=this,s="loglevel";function l(){var e;if("undefined"!=typeof window){try{e=window.localStorage[s]}catch(e){}if(void 0===e)try{var t=window.document.cookie,n=t.indexOf(encodeURIComponent(s)+"=");-1!==n&&(e=/^([^;]+)/.exec(t.slice(n))[1])}catch(e){}return void 0===i.levels[e]&&(e=void 0),e}}e&&(s+=":"+e),i.name=e,i.levels={TRACE:0,DEBUG:1,INFO:2,WARN:3,ERROR:4,SILENT:5},i.methodFactory=r||c,i.getLevel=function(){return o},i.setLevel=function(t,r){if("string"==typeof t&&void 0!==i.levels[t.toUpperCase()]&&(t=i.levels[t.toUpperCase()]),!("number"==typeof t&&t>=0&&t<=i.levels.SILENT))throw"log.setLevel() called with invalid level: "+t;if(o=t,!1!==r&&function(e){var t=(n[e]||"silent").toUpperCase();if("undefined"!=typeof window){try{return void(window.localStorage[s]=t)}catch(e){}try{window.document.cookie=encodeURIComponent(s)+"="+t+";"}catch(e){}}}(t),a.call(i,t,e),"undefined"==typeof console&&t<i.levels.SILENT)return"No console available for logging"},i.setDefaultLevel=function(e){l()||i.setLevel(e,!1)},i.enableAll=function(e){i.setLevel(i.levels.TRACE,e)},i.disableAll=function(e){i.setLevel(i.levels.SILENT,e)};var u=l();null==u&&(u=null==t?"WARN":t),i.setLevel(u,!1)}var u=new l,d={};u.getLogger=function(e){if("string"!=typeof e||""===e)throw new TypeError("You must supply a name when creating a logger.");var t=d[e];return t||(t=d[e]=new l(e,u.getLevel(),u.methodFactory)),t};var p="undefined"!=typeof window?window.log:void 0;return u.noConflict=function(){return"undefined"!=typeof window&&window.log===u&&(window.log=p),u},u.getLoggers=function(){return d},u}))})).noConflict)(),a=i.getLogger(t.Logger.EDITOR);a.setDefaultLevel(t.LogLevel.ERROR);i.getLogger(t.Logger.SMARTGUIDE);a.setDefaultLevel(t.LogLevel.ERROR);var s=i.getLogger(t.Logger.MODEL);s.setDefaultLevel(t.LogLevel.ERROR);var c=i.getLogger(t.Logger.GRABBER);c.setDefaultLevel(t.LogLevel.ERROR);var l=i.getLogger(t.Logger.RENDERER);l.setDefaultLevel(t.LogLevel.ERROR);var u=i.getLogger(t.Logger.RECOGNIZER);u.setDefaultLevel(t.LogLevel.ERROR);var d=i.getLogger(t.Logger.EVENT);d.setDefaultLevel(t.LogLevel.ERROR),i.getLogger(t.Logger.UTIL).setDefaultLevel(t.LogLevel.ERROR),i.getLogger("test").setDefaultLevel(t.LogLevel.ERROR);var p=o((function(e,t){var r=/^\[object .+?Constructor\]$/,o=/^(?:0|[1-9]\d*)$/,i={};i["[object Float32Array]"]=i["[object Float64Array]"]=i["[object Int8Array]"]=i["[object Int16Array]"]=i["[object Int32Array]"]=i["[object Uint8Array]"]=i["[object Uint8ClampedArray]"]=i["[object Uint16Array]"]=i["[object Uint32Array]"]=!0,i["[object Arguments]"]=i["[object Array]"]=i["[object ArrayBuffer]"]=i["[object Boolean]"]=i["[object DataView]"]=i["[object Date]"]=i["[object Error]"]=i["[object Function]"]=i["[object Map]"]=i["[object Number]"]=i["[object Object]"]=i["[object RegExp]"]=i["[object Set]"]=i["[object String]"]=i["[object WeakMap]"]=!1;var a="object"==typeof n&&n&&n.Object===Object&&n,s="object"==typeof self&&self&&self.Object===Object&&self,c=a||s||Function("return this")(),l=t&&!t.nodeType&&t,u=l&&e&&!e.nodeType&&e,d=u&&u.exports===l,p=d&&a.process,h=function(){try{var e=u&&u.require&&u.require("util").types;return e||p&&p.binding&&p.binding("util")}catch(e){}}(),f=h&&h.isTypedArray;function g(e,t,n){switch(n.length){case 0:return e.call(t);case 1:return e.call(t,n[0]);case 2:return e.call(t,n[0],n[1]);case 3:return e.call(t,n[0],n[1],n[2])}return e.apply(t,n)}var m,v,y,b=Array.prototype,x=Function.prototype,w=Object.prototype,E=c["__core-js_shared__"],k=x.toString,_=w.hasOwnProperty,S=(m=/[^.]+$/.exec(E&&E.keys&&E.keys.IE_PROTO||""))?"Symbol(src)_1."+m:"",T=w.toString,C=k.call(Object),P=RegExp("^"+k.call(_).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),R=d?c.Buffer:void 0,L=c.Symbol,M=c.Uint8Array,I=R?R.allocUnsafe:void 0,A=(v=Object.getPrototypeOf,y=Object,function(e){return v(y(e))}),O=Object.create,z=w.propertyIsEnumerable,N=b.splice,D=L?L.toStringTag:void 0,j=function(){try{var e=le(Object,"defineProperty");return e({},"",{}),e}catch(e){}}(),H=R?R.isBuffer:void 0,X=Math.max,U=Date.now,W=le(c,"Map"),Y=le(Object,"create"),B=function(){function e(){}return function(t){if(!we(t))return{};if(O)return O(t);e.prototype=t;var n=new e;return e.prototype=void 0,n}}();function G(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function F(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function J(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function K(e){var t=this.__data__=new F(e);this.size=t.size}function V(e,t){var n=me(e),r=!n&&ge(e),o=!n&&!r&&ye(e),i=!n&&!r&&!o&&ke(e),a=n||r||o||i,s=a?function(e,t){for(var n=-1,r=Array(e);++n<e;)r[n]=t(n);return r}(e.length,String):[],c=s.length;for(var l in e)!t&&!_.call(e,l)||a&&("length"==l||o&&("offset"==l||"parent"==l)||i&&("buffer"==l||"byteLength"==l||"byteOffset"==l)||ue(l,c))||s.push(l);return s}function q(e,t,n){(void 0!==n&&!fe(e[t],n)||void 0===n&&!(t in e))&&Q(e,t,n)}function Z(e,t,n){var r=e[t];_.call(e,t)&&fe(r,n)&&(void 0!==n||t in e)||Q(e,t,n)}function $(e,t){for(var n=e.length;n--;)if(fe(e[n][0],t))return n;return-1}function Q(e,t,n){"__proto__"==t&&j?j(e,t,{configurable:!0,enumerable:!0,value:n,writable:!0}):e[t]=n}G.prototype.clear=function(){this.__data__=Y?Y(null):{},this.size=0},G.prototype.delete=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t},G.prototype.get=function(e){var t=this.__data__;if(Y){var n=t[e];return"__lodash_hash_undefined__"===n?void 0:n}return _.call(t,e)?t[e]:void 0},G.prototype.has=function(e){var t=this.__data__;return Y?void 0!==t[e]:_.call(t,e)},G.prototype.set=function(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=Y&&void 0===t?"__lodash_hash_undefined__":t,this},F.prototype.clear=function(){this.__data__=[],this.size=0},F.prototype.delete=function(e){var t=this.__data__,n=$(t,e);return!(n<0)&&(n==t.length-1?t.pop():N.call(t,n,1),--this.size,!0)},F.prototype.get=function(e){var t=this.__data__,n=$(t,e);return n<0?void 0:t[n][1]},F.prototype.has=function(e){return $(this.__data__,e)>-1},F.prototype.set=function(e,t){var n=this.__data__,r=$(n,e);return r<0?(++this.size,n.push([e,t])):n[r][1]=t,this},J.prototype.clear=function(){this.size=0,this.__data__={hash:new G,map:new(W||F),string:new G}},J.prototype.delete=function(e){var t=ce(this,e).delete(e);return this.size-=t?1:0,t},J.prototype.get=function(e){return ce(this,e).get(e)},J.prototype.has=function(e){return ce(this,e).has(e)},J.prototype.set=function(e,t){var n=ce(this,e),r=n.size;return n.set(e,t),this.size+=n.size==r?0:1,this},K.prototype.clear=function(){this.__data__=new F,this.size=0},K.prototype.delete=function(e){var t=this.__data__,n=t.delete(e);return this.size=t.size,n},K.prototype.get=function(e){return this.__data__.get(e)},K.prototype.has=function(e){return this.__data__.has(e)},K.prototype.set=function(e,t){var n=this.__data__;if(n instanceof F){var r=n.__data__;if(!W||r.length<199)return r.push([e,t]),this.size=++n.size,this;n=this.__data__=new J(r)}return n.set(e,t),this.size=n.size,this};var ee,te=function(e,t,n){for(var r=-1,o=Object(e),i=n(e),a=i.length;a--;){var s=i[ee?a:++r];if(!1===t(o[s],s,o))break}return e};function ne(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":D&&D in Object(e)?function(e){var t=_.call(e,D),n=e[D];try{e[D]=void 0;var r=!0}catch(e){}var o=T.call(e);r&&(t?e[D]=n:delete e[D]);return o}(e):function(e){return T.call(e)}(e)}function re(e){return Ee(e)&&"[object Arguments]"==ne(e)}function oe(e){return!(!we(e)||function(e){return!!S&&S in e}(e))&&(be(e)?P:r).test(function(e){if(null!=e){try{return k.call(e)}catch(e){}try{return e+""}catch(e){}}return""}(e))}function ie(e){if(!we(e))return function(e){var t=[];if(null!=e)for(var n in Object(e))t.push(n);return t}(e);var t=de(e),n=[];for(var r in e)("constructor"!=r||!t&&_.call(e,r))&&n.push(r);return n}function ae(e,t,n,r,o){e!==t&&te(t,(function(i,a){if(o||(o=new K),we(i))!function(e,t,n,r,o,i,a){var s=pe(e,n),c=pe(t,n),l=a.get(c);if(l)return void q(e,n,l);var u=i?i(s,c,n+"",e,t,a):void 0,d=void 0===u;if(d){var p=me(c),h=!p&&ye(c),f=!p&&!h&&ke(c);u=c,p||h||f?me(s)?u=s:Ee(v=s)&&ve(v)?u=function(e,t){var n=-1,r=e.length;t||(t=Array(r));for(;++n<r;)t[n]=e[n];return t}(s):h?(d=!1,u=function(e,t){if(t)return e.slice();var n=e.length,r=I?I(n):new e.constructor(n);return e.copy(r),r}(c,!0)):f?(d=!1,g=c,m=!0?function(e){var t=new e.constructor(e.byteLength);return new M(t).set(new M(e)),t}(g.buffer):g.buffer,u=new g.constructor(m,g.byteOffset,g.length)):u=[]:function(e){if(!Ee(e)||"[object Object]"!=ne(e))return!1;var t=A(e);if(null===t)return!0;var n=_.call(t,"constructor")&&t.constructor;return"function"==typeof n&&n instanceof n&&k.call(n)==C}(c)||ge(c)?(u=s,ge(s)?u=function(e){return function(e,t,n,r){var o=!n;n||(n={});var i=-1,a=t.length;for(;++i<a;){var s=t[i],c=r?r(n[s],e[s],s,n,e):void 0;void 0===c&&(c=e[s]),o?Q(n,s,c):Z(n,s,c)}return n}(e,_e(e))}(s):we(s)&&!be(s)||(u=function(e){return"function"!=typeof e.constructor||de(e)?{}:B(A(e))}(c))):d=!1}var g,m;var v;d&&(a.set(c,u),o(u,c,r,i,a),a.delete(c));q(e,n,u)}(e,t,a,n,ae,r,o);else{var s=r?r(pe(e,a),i,a+"",e,t,o):void 0;void 0===s&&(s=i),q(e,a,s)}}),_e)}function se(e,t){return he(function(e,t,n){return t=X(void 0===t?e.length-1:t,0),function(){for(var r=arguments,o=-1,i=X(r.length-t,0),a=Array(i);++o<i;)a[o]=r[t+o];o=-1;for(var s=Array(t+1);++o<t;)s[o]=r[o];return s[t]=n(a),g(e,this,s)}}(e,t,Ce),e+"")}function ce(e,t){var n,r,o=e.__data__;return("string"==(r=typeof(n=t))||"number"==r||"symbol"==r||"boolean"==r?"__proto__"!==n:null===n)?o["string"==typeof t?"string":"hash"]:o.map}function le(e,t){var n=function(e,t){return null==e?void 0:e[t]}(e,t);return oe(n)?n:void 0}function ue(e,t){var n=typeof e;return!!(t=null==t?9007199254740991:t)&&("number"==n||"symbol"!=n&&o.test(e))&&e>-1&&e%1==0&&e<t}function de(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||w)}function pe(e,t){if(("constructor"!==t||"function"!=typeof e[t])&&"__proto__"!=t)return e[t]}var he=function(e){var t=0,n=0;return function(){var r=U(),o=16-(r-n);if(n=r,o>0){if(++t>=800)return arguments[0]}else t=0;return e.apply(void 0,arguments)}}(j?function(e,t){return j(e,"toString",{configurable:!0,enumerable:!1,value:(n=t,function(){return n}),writable:!0});var n}:Ce);function fe(e,t){return e===t||e!=e&&t!=t}var ge=re(function(){return arguments}())?re:function(e){return Ee(e)&&_.call(e,"callee")&&!z.call(e,"callee")},me=Array.isArray;function ve(e){return null!=e&&xe(e.length)&&!be(e)}var ye=H||function(){return!1};function be(e){if(!we(e))return!1;var t=ne(e);return"[object Function]"==t||"[object GeneratorFunction]"==t||"[object AsyncFunction]"==t||"[object Proxy]"==t}function xe(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=9007199254740991}function we(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}function Ee(e){return null!=e&&"object"==typeof e}var ke=f?function(e){return function(t){return e(t)}}(f):function(e){return Ee(e)&&xe(e.length)&&!!i[ne(e)]};function _e(e){return ve(e)?V(e,!0):ie(e)}var Se,Te=(Se=function(e,t,n){ae(e,t,n)},se((function(e,t){var n=-1,r=t.length,o=r>1?t[r-1]:void 0,i=r>2?t[2]:void 0;for(o=Se.length>3&&"function"==typeof o?(r--,o):void 0,i&&function(e,t,n){if(!we(n))return!1;var r=typeof t;return!!("number"==r?ve(n)&&ue(t,n.length):"string"==r&&t in n)&&fe(n[t],e)}(t[0],t[1],i)&&(o=r<3?void 0:o,r=1),e=Object(e);++n<r;){var a=t[n];a&&Se(e,a,n,o)}return e})));function Ce(e){return e}e.exports=Te})),h={recognitionParams:{type:"TEXT",protocol:"WEBSOCKET",server:{scheme:"https",host:"cloud.myscript.com",applicationKey:void 0,hmacKey:void 0,useWindowLocation:!1,websocket:{pingEnabled:!0,pingDelay:3e4,maxPingLostCount:10,autoReconnect:!0,maxRetryCount:2,fileChunkSize:3e5}},iink:{alwaysConnected:!0,lang:"en_US",export:{"image-resolution":300,jiix:{"bounding-box":!1,strokes:!1,text:{chars:!1,words:!0}}},renderer:{debug:{"draw-text-boxes":!1,"draw-image-boxes":!1}},math:{mimeTypes:["application/x-latex","application/mathml+xml"],solver:{enable:!0,"fractional-part-digits":3,"decimal-separator":".","rounding-mode":"half up","angle-unit":"deg"},margin:{bottom:10,left:15,right:15,top:10}},text:{guides:{enable:!0},smartGuide:!0,smartGuideFadeOut:{enable:!1,duration:1e4},mimeTypes:["text/plain","application/vnd.myscript.jiix"],margin:{top:20,left:10,right:10}},diagram:{mimeTypes:["application/vnd.myscript.jiix"],margin:{bottom:10,left:15,right:15,top:10}},"raw-content":{recognition:{text:!1,shape:!1}}}},listenerOptions:{capture:!1,passive:!0},undoRedoMaxStackSize:20,xyFloatPrecision:0,timestampFloatPrecision:0,triggerDelay:2e3,processDelay:0,resizeTriggerDelay:200,triggers:{exportContent:"POINTER_UP",addStrokes:"POINTER_UP"},restConversionState:"",renderingParams:{stroker:"quadratic",minHeight:100,minWidth:100}};var f=o((function(e,t){e.exports=function(e){function t(r){if(n[r])return n[r].exports;var o=n[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,t),o.l=!0,o.exports}var n={};return t.m=e,t.c=n,t.i=function(e){return e},t.d=function(e,n,r){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:r})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=1)}([function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};t.default=function e(t){var n=this;(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")})(this,e),this.toJSON=function(e){if("string"!=typeof e)return console.error("Need a CSS string but given ",void 0===e?"undefined":r(e),e),"Not a valid CSS..!";var t={},o=void 0,i=void 0,a=void 0;try{e.split("{").forEach((function(e){if(i=e.trim())if(-1===i.indexOf("}"))t[i]={},o=i;else{i.substring(0,i.indexOf("}")).split(";").forEach((function(e){(a=e.split(":"))&&2===a.length&&(t[o][a[0].trim().replace(/^\"|\"$/g,"")]=n._trimSemiColon(a[1].trim().replace(/^\"|\"$/g,"")))}));try{(o=i.split("}")[1].trim())&&(t[o]={})}catch(e){}}}))}catch(e){return"Not a valid CSS..!"}return t},this.toCSS=function(e){if("object"!==(void 0===e?"undefined":r(e)))return console.error("Need a JSON object but given ",void 0===e?"undefined":r(e),e),"Not a valid JSON..!";var t="";try{for(var n in e)if(e.hasOwnProperty(n)){for(var o in t+=n+" {\n",e[n])e[n].hasOwnProperty(o)&&(t+=o+": "+e[n][o]+";\n");t+="}\n"}}catch(e){return"Not a valid JSON..!"}return t},this._trimSemiColon=function(e){return";"===e.slice(-1)?e.slice(0,n.length-1):e}}},function(e,t,n){e.exports=n(0).default}])})),g=r(f),m=(f.JsonCSS,new g);function v(e){var t=m.toCSS({css:e});return t.substring(6,t.length-3)}var y={ink:{color:"#000000","-myscript-pen-width":1,"-myscript-pen-fill-style":"none","-myscript-pen-fill-color":"#FFFFFF00"},".math":{"font-family":"STIXGeneral"},".math-solved":{"font-family":"STIXGeneral",color:"#A8A8A8FF"},".text":{"font-family":"Open Sans","font-size":10}},b=new g;function x(e){return b.toCSS(e)}var w=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9];function E(e,t){var n;return t||0===t?(n=t>10?w[10]:w[t],Math.round(e*n)/n):e}function k(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,i=e;i.changedTouches&&(i=i.changedTouches[0]);var a=t.getBoundingClientRect();return{x:E(i.clientX-a.left-t.clientLeft-o,n.xyFloatPrecision),y:E(i.clientY-a.top-t.clientTop-r,n.xyFloatPrecision),t:E(Date.now(),n.timestampFloatPrecision)}}var _=Object.freeze({__proto__:null,attach:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,o=0;function i(){"None"!==window.getSelection().type&&window.getSelection().removeAllRanges()}function a(e){var t=document.querySelector(".more-menu");return!(e.target.classList.contains("ellipsis")||e.target.classList.contains("more-menu")||e.target.classList.contains("options-label-button")||!t||"none"===t.style.display)&&(t.style.display="none",!0)}function s(e){var t=document.querySelector(".candidates");return!(e.target.classList.contains("candidates")||"SPAN"===e.target.tagName||!t||"none"===t.style.display)&&(t.style.display="none",!0)}function l(o){var l=o.target.id===t.domElement.id||o.target.classList.contains("ms-canvas");if(void 0!==this.activePointerId)this.activePointerId===o.pointerId&&c.trace("".concat(o.type," event with the same id without any pointer up"),o.pointerId);else if(2!==o.button&&2!==o.buttons&&l){if(!a(o)&&!s(o)){this.activePointerId=o.pointerId;var u=o.pointerId>2147483647?-1:o.pointerId;i(),o.stopPropagation(),t.pointerDown(k(o,e,t.configuration,n,r),o.pointerType,u)}}else o.target.classList.contains("ellipsis")||o.target.classList.contains("tag-icon")?(a(o),s(o)):(a(o),s(o),this.smartGuidePointerDown=!0,this.downSmartGuidePoint=k(o,e,t.configuration))}function u(a){if(void 0!==this.activePointerId&&this.activePointerId===a.pointerId)i(),t.pointerMove(k(a,e,t.configuration,n,r));else if(this.smartGuidePointerDown){var s=k(a,e,t.configuration,n,r),l=Math.abs(this.downSmartGuidePoint.x-s.x),u=Math.abs(this.downSmartGuidePoint.y-s.y);if(o=Math.max(l,o),l<5&&u>5&&o<15||l>5&&u>5&&o<15){this.activePointerId=a.pointerId;var d=a.pointerId>2147483647?-1:a.pointerId;i(),t.pointerDown(this.downSmartGuidePoint,a.pointerType,d)}}else c.trace("".concat(a.type," event from another pointerid (").concat(a.pointerId,")"),this.activePointerId)}function d(i){o=0,this.smartGuidePointerDown=!1;var a=["smartguide","prompter-text-container","prompter-text","tag-icon","ellipsis"],s=["ps__rail-x","ps__thumb-x"],l=i.relatedTarget&&(a.includes(i.relatedTarget.className)||s.includes(i.relatedTarget.className)),u=i.relatedTarget&&i.target&&(a.includes(i.target.className)||s.includes(i.target.className)),d=i.relatedTarget&&i.target&&("SPAN"===i.target.tagName||"SPAN"===i.relatedTarget.tagName);l||u||d?i.stopPropagation():void 0!==this.activePointerId&&this.activePointerId===i.pointerId?(this.activePointerId=void 0,i.stopPropagation(),t.pointerUp(k(i,e,t.configuration,n,r))):c.trace("".concat(i.type," event from another pointerid (").concat(i.pointerId,")"),this.activePointerId)}var p={options:t.configuration.listenerOptions,listeners:[{types:["pointerdown"],listener:l},{types:["pointermove"],listener:u},{types:["pointerup","pointerout","pointerleave","pointercancel"],listener:d}]};return c.debug("attaching listeners",p),p.listeners.forEach((function(t){t.types.forEach((function(n){return e.addEventListener(n,t.listener,p.options)}))})),p},detach:function(e,t){c.debug("detaching listeners",t),t.listeners.forEach((function(n){n.types.forEach((function(r){return e.removeEventListener(r,n.listener,t.options)}))}))}});function S(e){return(S="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function T(e,t,n,r,o,i,a){try{var s=e[i](a),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,o)}function C(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){T(i,r,o,a,s,"next",e)}function s(e){T(i,r,o,a,s,"throw",e)}a(void 0)}))}}function P(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function R(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){o=!0,i=e}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(e,t)||M(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function L(e){return function(e){if(Array.isArray(e))return I(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||M(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function M(e,t){if(e){if("string"==typeof e)return I(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?I(e,t):void 0}}function I(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function A(e,t,n){n&&n.drawStroke(e,t)}var O={table:"table",shape:"shape",recognizedShape:"recognizedShape",ellipse:"ellipse",line:"line"};function z(e){var t=(e+Math.PI)%(2*Math.PI)-Math.PI;return t<-Math.PI&&(t+=2*Math.PI),t}function N(e,t,n,r){var o=z(n+Math.PI*(7/8)),i=z(n-Math.PI*(7/8)),a=e;a.save();try{a.fillStyle=a.strokeStyle,a.moveTo(t.x,t.y),a.beginPath(),a.lineTo(t.x+r*Math.cos(o),t.y+r*Math.sin(o)),a.lineTo(t.x+r*Math.cos(i),t.y+r*Math.sin(i)),a.lineTo(t.x,t.y),a.fill()}finally{a.restore()}}function D(e,t){var n=function(e,t,n,r,o,i,a){var s=Math.cos(o),c=Math.sin(o),l=s,u=c;s*=n,l*=r,c*=n,u*=r;var d=Math.floor(Math.abs(a)/.02),p=[];e.save();try{e.beginPath();for(var h=0;h<=d;h++){var f=i+h/d*a,g=Math.atan2(Math.sin(f)/r,Math.cos(f)/n),m=Math.cos(g),v=Math.sin(g),y=t.x+s*m-u*v,b=t.y+l*v+c*m;0===h?e.moveTo(y,b):e.lineTo(y,b),0!==h&&h!==d||p.push({x:y,y:b})}e.stroke()}finally{e.restore()}return p}(e,t.center,t.maxRadius,t.minRadius,t.orientation,t.startAngle,t.sweepAngle);t.beginDecoration&&"ARROW_HEAD"===t.beginDecoration&&N(e,n[0],t.beginTangentAngle,12),t.endDecoration&&"ARROW_HEAD"===t.endDecoration&&N(e,n[1],t.endTangentAngle,12)}function j(e,t,n){e.save();try{e.beginPath(),e.moveTo(t.x,t.y),e.lineTo(n.x,n.y),e.stroke()}finally{e.restore()}}function H(e,t){l.debug("draw ".concat(t.type," symbol"));var n=e;n.save();try{if(n.lineWidth=t.width,n.strokeStyle=t.color,t.elementType)switch(t.elementType){case O.shape:H(n,t.candidates[t.selectedCandidateIndex]);break;case O.table:t.lines.forEach((function(e){return H(n,e)}));break;case O.line:j(n,t.data.p1,t.data.p2);break;default:l.error("".concat(t.elementType," not implemented"))}else switch(t.type){case O.ellipse:D(n,t);break;case O.line:!function(e,t){j(e,t.firstPoint,t.lastPoint),"ARROW_HEAD"===t.beginDecoration&&N(e,t.firstPoint,t.beginTangentAngle,12),"ARROW_HEAD"===t.endDecoration&&N(e,t.lastPoint,t.endTangentAngle,12)}(n,t);break;case O.recognizedShape:t.primitives.forEach((function(e){return H(n,e)}));break;default:l.error("".concat(t.type," not implemented"))}}finally{n.restore()}}var X={inputCharacter:"inputCharacter",char:"char",string:"string",textLine:"textLine"};function U(e,t){!function(e,t,n){var r=e;r.save();try{r.font="".concat(n.textHeight,"px serif"),r.textAlign="CENTER"===n.justificationType?"center":"left",r.textBaseline="bottom",r.fillStyle=r.strokeStyle,r.fillText(t,n.topLeftPoint.x,n.topLeftPoint.y+n.height)}finally{r.restore()}}(e,t.label,t.data),t.underlineList.forEach((function(n){!function(e,t,n,r){var o=r.width/n.length;j(e,{x:r.topLeftPoint.x+t.data.firstCharacter*o,y:r.topLeftPoint.y+r.height},{x:r.topLeftPoint.x+t.data.lastCharacter*o,y:r.topLeftPoint.y+r.height})}(e,n,t.label,t.data)}))}function W(e,t,n,r,o){var i=Math.sqrt(Math.pow(t-r[o-1],2)+Math.pow(e-n[o-1],2));return isNaN(i)?0:i}function Y(e,t,n,r,o,i){var a=o[i-1]+W(e,t,n,r,i);return isNaN(a)?0:a}function B(e){return Object.assign({},{type:"stroke",x:[],y:[],t:[],p:[],l:[],width:0},e)}function G(e,t){var n,r,o,i,a,c,l,u=e;return n=t.x,r=t.y,o=u.x,i=u.y,a=u.width,c=2+a/4,l=!1,(0===o.length||0===i.length||Math.abs(o[o.length-1]-n)>=c||Math.abs(i[i.length-1]-r)>=c)&&(l=!0),l?(u.x.push(t.x),u.y.push(t.y),u.t.push(t.t),u.p.push(function(e,t,n,r,o,i){var a=1,s=W(e,t,n,r,i),c=Y(e,t,n,r,o,i);0===c?a=.5:s===c?a=1:s<10?a=.2+Math.pow(.1*s,.4):s>c-10&&(a=.2+Math.pow(.1*(c-s),.4));var l=a*Math.max(.1,1-.1*Math.sqrt(s));return isNaN(parseFloat(l))?.5:l}(t.x,t.y,u.x,u.y,u.l,u.x.length-1)),u.l.push(Y(t.x,t.y,u.x,u.y,u.l,u.x.length-1))):s.trace("ignore filtered point",t),u}function F(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e.x.length,r=B({color:e.color,width:e.width}),o=t;o<n;o++)G(r,{x:e.x[o],y:e.y[o],t:e.t[o]});return r}function J(e,t){var n;return void 0!==t&&t>=0&&t<e.x.length&&(n={x:e.x[t],y:e.y[t],t:e.t[t],p:e.p[t],l:e.l[t]}),n}function K(e,t){return{minX:Math.min(e.minX,t.minX),maxX:Math.max(e.maxX,t.maxX),minY:Math.min(e.minY,t.minY),maxY:Math.max(e.maxY,t.maxY)}}function V(e){return{minX:Math.min(e.firstPoint.x,e.lastPoint.x),maxX:Math.max(e.firstPoint.x,e.lastPoint.x),minY:Math.min(e.firstPoint.y,e.lastPoint.y),maxY:Math.max(e.firstPoint.y,e.lastPoint.y)}}function q(e){var t=Math.cos(e.orientation),n=Math.sin(e.orientation),r=t,o=n;t*=e.maxRadius,r*=e.minRadius,n*=e.maxRadius,o*=e.minRadius;for(var i=Math.abs(e.sweepAngle)/.02,a=[],s=[],c=0;c<=i;c++){var l=e.startAngle+c/i*e.sweepAngle,u=Math.atan2(Math.sin(l)/e.minRadius,Math.cos(l)/e.maxRadius),d=Math.cos(u),p=Math.sin(u);a.push(e.center.x+(t*d-o*p)),s.push(e.center.y+(r*p+n*d))}return{minX:Math.min.apply(Math,a),maxX:Math.max.apply(Math,a),minY:Math.min.apply(Math,s),maxY:Math.max.apply(Math,s)}}function Z(e){return{minX:e.data.topLeftPoint.x,maxX:e.data.topLeftPoint.x+e.data.width,minY:e.data.topLeftPoint.y,maxY:e.data.topLeftPoint.y+e.data.height}}function $(e){return{minX:e.boundingBox.x,maxX:e.boundingBox.x+e.boundingBox.width,minY:e.boundingBox.y,maxY:e.boundingBox.y+e.boundingBox.height}}function Q(e){return{minX:Math.min.apply(Math,L(e.x)),maxX:Math.max.apply(Math,L(e.x)),minY:Math.min.apply(Math,L(e.y)),maxY:Math.max.apply(Math,L(e.y))}}function ee(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{minX:Number.MAX_VALUE,maxX:Number.MIN_VALUE,minY:Number.MAX_VALUE,maxY:Number.MIN_VALUE},n=t;return n=e.filter((function(e){return"stroke"===e.type})).map(Q).reduce(K,n),n=e.filter((function(e){return"clef"===e.type})).map($).reduce(K,n),n=e.filter((function(e){return"line"===e.type})).map(V).reduce(K,n),n=e.filter((function(e){return"ellipse"===e.type})).map(q).reduce(K,n),n=e.filter((function(e){return"textLine"===e.type})).map(Z).reduce(K,n)}function te(e){return{currentStroke:void 0,rawStrokes:[],strokeGroups:[],lastPositions:{lastSentPosition:-1,lastReceivedPosition:-1,lastRenderedPosition:-1},defaultSymbols:[],recognizedSymbols:void 0,exports:void 0,rawResults:{convert:void 0,exports:void 0},creationTime:(new Date).getTime(),modificationTime:void 0}}function ne(e){var t=e;return t.currentStroke=void 0,t.rawStrokes=[],t.strokeGroups=[],t.lastPositions.lastSentPosition=-1,t.lastPositions.lastReceivedPosition=-1,t.lastPositions.lastRenderedPosition=-1,t.recognizedSymbols=void 0,t.exports=void 0,t.rawResults.convert=void 0,t.rawResults.exports=void 0,t}function re(e){return!!e.recognizedSymbols&&e.rawStrokes.length!==e.recognizedSymbols.filter((function(e){return"stroke"===e.type})).length}function oe(e,t){var n=e;return s.debug("addStroke",t),n.rawStrokes.push(t),n}function ie(e,t,n){var r=e;s.debug("addStroke",t);var o=r.strokeGroups.length-1;if(r.strokeGroups[o]&&r.strokeGroups[o].penStyle===n)r.strokeGroups[o].strokes.push(t);else{var i={penStyle:n,strokes:[]},a={};Object.assign(a,t),i.strokes.push(a),r.strokeGroups.push(i)}return r}function ae(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.lastPositions.lastReceivedPosition+1;return e.rawStrokes.slice(t)}function se(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:96;if(n&&n["-myscript-pen-width"]){var o=n["-myscript-pen-width"]*r/25.4;Object.assign(n,{width:o/2})}var i=e;return s.trace("initPendingStroke",t),i.currentStroke=B(n),i.currentStroke=G(i.currentStroke,t),i}function ce(e,t){var n=e;return n.currentStroke&&(s.trace("appendToPendingStroke",t),n.currentStroke=G(n.currentStroke,t)),n}function le(e,t,n){var r=e;if(r.currentStroke){s.trace("endPendingStroke",t);var o=G(r.currentStroke,t);oe(r,o),ie(r,o,n),delete r.currentStroke}return r}function ue(e){var t={minX:Number.MAX_VALUE,maxX:Number.MIN_VALUE,minY:Number.MAX_VALUE,maxY:Number.MIN_VALUE};return e.defaultSymbols&&e.defaultSymbols.length>0&&(t=ee(e.defaultSymbols,t)),e.recognizedSymbols&&e.recognizedSymbols.length>0?(t=ee(e.recognizedSymbols,t),t=ee(ae(e),t)):t=ee(e.rawStrokes,t),t}function de(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.rawStrokes.length-1,n=e;return n.lastPositions.lastSentPosition=t,n}function pe(e){var t=e;return t.lastPositions.lastReceivedPosition=t.lastPositions.lastSentPosition,t}function he(e){var t=e;return t.lastPositions.lastSentPosition=-1,t.lastPositions.lastReceivedPosition=-1,t}function fe(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.recognizedSymbols?e.recognizedSymbols.length-1:-1,n=e;return n.lastPositions.lastRenderedPosition=t,n}function ge(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.lastPositions.lastRenderedPosition+1;return e.recognizedSymbols?e.recognizedSymbols.slice(t):[]}function me(e){var t=Object.assign({},e);return t.defaultSymbols=L(e.defaultSymbols),t.currentStroke=e.currentStroke?Object.assign({},e.currentStroke):void 0,t.rawStrokes=L(e.rawStrokes),t.strokeGroups=JSON.parse(JSON.stringify(e.strokeGroups)),t.lastPositions=Object.assign({},e.lastPositions),t.exports=e.exports?Object.assign({},e.exports):void 0,t.rawResults=Object.assign({},e.rawResults),t.recognizedSymbols=e.recognizedSymbols?L(e.recognizedSymbols):void 0,t}function ve(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.reduce((function(e,t){var n=e;return n.recognizedSymbols=t.recognizedSymbols,n.lastPositions.lastSentPosition=t.lastPositions.lastSentPosition,n.lastPositions.lastReceivedPosition=t.lastPositions.lastReceivedPosition,n.lastPositions.lastRenderedPosition=t.lastPositions.lastRenderedPosition,n.rawResults=t.rawResults,n.exports=t.exports,n}))}var ye=Object.freeze({__proto__:null,createModel:te,clearModel:ne,needRedraw:re,addStroke:oe,addStrokeToGroup:ie,extractPendingStrokes:ae,initPendingStroke:se,appendToPendingStroke:ce,endPendingStroke:le,getBorderCoordinates:ue,extractStrokesFromInkRange:function(e,t,n,r,o){return e.rawStrokes.slice(t,n+1).map((function(e,t,n){return n.length<2?F(e,r,o+1):0===t?F(e,r):t===n.length-1?F(e,0,o+1):e}))},updateModelSentPosition:de,updateModelReceivedPosition:pe,resetModelPositions:he,resetModelRendererPosition:function(e){var t=e;return t.lastPositions.lastRenderedPosition=-1,t},updateModelRenderedPosition:fe,extractPendingRecognizedSymbols:ge,cloneModel:me,mergeModels:ve});function be(e){return function(e){if(e){var t=e.getContext("2d");return(window.devicePixelRatio||1)/(t.webkitBackingStorePixelRatio||t.mozBackingStorePixelRatio||t.msBackingStorePixelRatio||t.oBackingStorePixelRatio||t.backingStorePixelRatio||1)}return 1}(document.createElement("canvas"))}function xe(e,t){var n=document.createElement("canvas");return n.classList.add(t),n.classList.add("ms-canvas"),e.appendChild(n),l.debug("canvas created",n),n}function we(e){return[e.renderingCanvas,e.capturingCanvas].forEach((function(t){var n=t.parentNode,r=n.clientWidth<e.minWidth?e.minWidth:n.clientWidth,o=n.clientHeight<e.minHeight?e.minHeight:n.clientHeight;t.width=r*e.pixelRatio,t.height=o*e.pixelRatio,t.style.width="".concat(r,"px"),t.style.height="".concat(o,"px"),t.getContext("2d").scale(e.pixelRatio,e.pixelRatio),l.debug("canvas size changed",t)})),e}function Ee(e,t,n){var r=t.elementType?t.elementType:t.type;l.trace("attempting to draw ".concat(r," symbol")),"stroke"===r?A(e,t,n):X[r]?function(e,t){l.debug("draw ".concat(t.type," symbol"));var n=e;n.save();try{if(n.lineWidth=t.width,n.strokeStyle=t.color,t.elementType)switch(t.elementType){case X.textLine:U(n,t);break;default:l.error("".concat(t.elementType," not implemented"))}else switch(t.type){case X.textLine:U(n,t);break;default:l.error("".concat(t.type," not implemented"))}}finally{n.restore()}}(e,t):O[r]?H(e,t):l.warn("impossible to draw ".concat(r," symbol"))}function ke(e,t,n){e.renderingCanvasContext.clearRect(0,0,e.renderingCanvas.width,e.renderingCanvas.height);var r=L(t.defaultSymbols);return t.recognizedSymbols?(r.push.apply(r,L(t.recognizedSymbols)),r.push.apply(r,L(ae(t)))):r.push.apply(r,L(t.rawStrokes)),r.forEach((function(t){return Ee(e.renderingCanvasContext,t,n)})),e.capturingCanvasContext.clearRect(0,0,e.capturingCanvas.width,e.capturingCanvas.height),t}var _e=Object.freeze({__proto__:null,getInfo:function(){return{type:"canvas"}},attach:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;l.debug("attach renderer",e);var r=be(),o=xe(e,"ms-rendering-canvas"),i=xe(e,"ms-capture-canvas"),a={pixelRatio:r,minHeight:t,minWidth:n,renderingCanvas:o,renderingCanvasContext:o.getContext("2d"),capturingCanvas:i,capturingCanvasContext:i.getContext("2d")};return we(a)},detach:function(e,t){l.debug("detach renderer",e),e.removeChild(t.renderingCanvas),e.removeChild(t.capturingCanvas)},resize:function(e,t,n){return this.drawModel(we(e),t,n)},drawCurrentStroke:function(e,t,n){return e.capturingCanvasContext.clearRect(0,0,e.capturingCanvas.width,e.capturingCanvas.height),l.trace("drawing current stroke ",t.currentStroke),A(e.capturingCanvasContext,t.currentStroke,n),t},drawModel:ke});function Se(e,t,n){var r=e.p*n;return[{x:e.x-Math.sin(t)*r,y:e.y+Math.cos(t)*r},{x:e.x+Math.sin(t)*r,y:e.y-Math.cos(t)*r}]}function Te(e,t){return{x:(t.x+e.x)/2,y:(t.y+e.y)/2,p:(t.p+e.p)/2}}function Ce(e,t){return Math.atan2(t.y-e.y,t.x-e.x)}function Pe(e,t,n){e.arc(t.x,t.y,n,0,2*Math.PI,!0)}function Re(e,t,n,r){var o=Se(t,Ce(t,n),r),i=Se(n,Ce(t,n),r);e.moveTo(o[0].x,o[0].y),e.lineTo(i[0].x,i[0].y),e.lineTo(i[1].x,i[1].y),e.lineTo(o[1].x,o[1].y)}function Le(e,t,n,r,o){var i=Se(t,Ce(t,r),o),a=Se(n,Ce(r,n),o),s=Se(r,Ce(t,n),o);e.moveTo(i[0].x,i[0].y),e.quadraticCurveTo(s[0].x,s[0].y,a[0].x,a[0].y),e.lineTo(a[1].x,a[1].y),e.quadraticCurveTo(s[1].x,s[1].y,i[1].x,i[1].y)}var Me=Object.freeze({__proto__:null,getInfo:function(){return{type:"canvas",name:"quadratic"}},drawStroke:function(e,t){var n=e,r=t.x.length,o=t.width>0?t.width:n.lineWidth,i=t.color?t.color:n.strokeStyle,a=J(t,0),s=r-2;n.save();try{if(n.beginPath(),r<3)Pe(n,a,.6*o);else{Pe(n,a,o*a.p),Re(n,a,Te(a,J(t,1)),o);for(var c=0;c<s;c++)Le(n,Te(J(t,c),J(t,c+1)),Te(J(t,c+1),J(t,c+2)),J(t,c+1),o);Re(n,Te(J(t,r-2),J(t,r-1)),J(t,r-1),o),function(e,t,n,r){var o=Ce(t,n),i=Se(n,o,r);e.moveTo(i[0].x,i[0].y);for(var a=1;a<=6;a++){var s=o-a*Math.PI/6;e.lineTo(n.x-n.p*r*Math.sin(s),n.y+n.p*r*Math.cos(s))}}(n,J(t,r-2),J(t,r-1),o)}n.closePath(),void 0!==i&&(n.fillStyle=i,n.fill())}finally{n.restore()}}}),Ie="http://www.w3.org/1999/xhtml",Ae={svg:"http://www.w3.org/2000/svg",xhtml:Ie,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function Oe(e){var t=e+="",n=t.indexOf(":");return n>=0&&"xmlns"!==(t=e.slice(0,n))&&(e=e.slice(n+1)),Ae.hasOwnProperty(t)?{space:Ae[t],local:e}:e}function ze(e){return function(){var t=this.ownerDocument,n=this.namespaceURI;return n===Ie&&t.documentElement.namespaceURI===Ie?t.createElement(e):t.createElementNS(n,e)}}function Ne(e){return function(){return this.ownerDocument.createElementNS(e.space,e.local)}}function De(e){var t=Oe(e);return(t.local?Ne:ze)(t)}function je(){}function He(e){return null==e?je:function(){return this.querySelector(e)}}function Xe(){return[]}function Ue(e){return new Array(e.length)}function We(e,t){this.ownerDocument=e.ownerDocument,this.namespaceURI=e.namespaceURI,this._next=null,this._parent=e,this.__data__=t}We.prototype={constructor:We,appendChild:function(e){return this._parent.insertBefore(e,this._next)},insertBefore:function(e,t){return this._parent.insertBefore(e,t)},querySelector:function(e){return this._parent.querySelector(e)},querySelectorAll:function(e){return this._parent.querySelectorAll(e)}};function Ye(e,t,n,r,o,i){for(var a,s=0,c=t.length,l=i.length;s<l;++s)(a=t[s])?(a.__data__=i[s],r[s]=a):n[s]=new We(e,i[s]);for(;s<c;++s)(a=t[s])&&(o[s]=a)}function Be(e,t,n,r,o,i,a){var s,c,l,u={},d=t.length,p=i.length,h=new Array(d);for(s=0;s<d;++s)(c=t[s])&&(h[s]=l="$"+a.call(c,c.__data__,s,t),l in u?o[s]=c:u[l]=c);for(s=0;s<p;++s)(c=u[l="$"+a.call(e,i[s],s,i)])?(r[s]=c,c.__data__=i[s],u[l]=null):n[s]=new We(e,i[s]);for(s=0;s<d;++s)(c=t[s])&&u[h[s]]===c&&(o[s]=c)}function Ge(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function Fe(e){return function(){this.removeAttribute(e)}}function Je(e){return function(){this.removeAttributeNS(e.space,e.local)}}function Ke(e,t){return function(){this.setAttribute(e,t)}}function Ve(e,t){return function(){this.setAttributeNS(e.space,e.local,t)}}function qe(e,t){return function(){var n=t.apply(this,arguments);null==n?this.removeAttribute(e):this.setAttribute(e,n)}}function Ze(e,t){return function(){var n=t.apply(this,arguments);null==n?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,n)}}function $e(e){return e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView}function Qe(e){return function(){this.style.removeProperty(e)}}function et(e,t,n){return function(){this.style.setProperty(e,t,n)}}function tt(e,t,n){return function(){var r=t.apply(this,arguments);null==r?this.style.removeProperty(e):this.style.setProperty(e,r,n)}}function nt(e,t){return e.style.getPropertyValue(t)||$e(e).getComputedStyle(e,null).getPropertyValue(t)}function rt(e){return function(){delete this[e]}}function ot(e,t){return function(){this[e]=t}}function it(e,t){return function(){var n=t.apply(this,arguments);null==n?delete this[e]:this[e]=n}}function at(e){return e.trim().split(/^|\s+/)}function st(e){return e.classList||new ct(e)}function ct(e){this._node=e,this._names=at(e.getAttribute("class")||"")}function lt(e,t){for(var n=st(e),r=-1,o=t.length;++r<o;)n.add(t[r])}function ut(e,t){for(var n=st(e),r=-1,o=t.length;++r<o;)n.remove(t[r])}function dt(e){return function(){lt(this,e)}}function pt(e){return function(){ut(this,e)}}function ht(e,t){return function(){(t.apply(this,arguments)?lt:ut)(this,e)}}function ft(){this.textContent=""}function gt(e){return function(){this.textContent=e}}function mt(e){return function(){var t=e.apply(this,arguments);this.textContent=null==t?"":t}}function vt(){this.innerHTML=""}function yt(e){return function(){this.innerHTML=e}}function bt(e){return function(){var t=e.apply(this,arguments);this.innerHTML=null==t?"":t}}function xt(){this.nextSibling&&this.parentNode.appendChild(this)}function wt(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function Et(){return null}function kt(){var e=this.parentNode;e&&e.removeChild(this)}function _t(){var e=this.cloneNode(!1),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function St(){var e=this.cloneNode(!0),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}ct.prototype={add:function(e){this._names.indexOf(e)<0&&(this._names.push(e),this._node.setAttribute("class",this._names.join(" ")))},remove:function(e){var t=this._names.indexOf(e);t>=0&&(this._names.splice(t,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(e){return this._names.indexOf(e)>=0}};var Tt={};"undefined"!=typeof document&&("onmouseenter"in document.documentElement||(Tt={mouseenter:"mouseover",mouseleave:"mouseout"}));function Ct(e,t,n){return e=Pt(e,t,n),function(t){var n=t.relatedTarget;n&&(n===this||8&n.compareDocumentPosition(this))||e.call(this,t)}}function Pt(e,t,n){return function(r){try{e.call(this,this.__data__,t,n)}finally{}}}function Rt(e){return e.trim().split(/^|\s+/).map((function(e){var t="",n=e.indexOf(".");return n>=0&&(t=e.slice(n+1),e=e.slice(0,n)),{type:e,name:t}}))}function Lt(e){return function(){var t=this.__on;if(t){for(var n,r=0,o=-1,i=t.length;r<i;++r)n=t[r],e.type&&n.type!==e.type||n.name!==e.name?t[++o]=n:this.removeEventListener(n.type,n.listener,n.capture);++o?t.length=o:delete this.__on}}}function Mt(e,t,n){var r=Tt.hasOwnProperty(e.type)?Ct:Pt;return function(o,i,a){var s,c=this.__on,l=r(t,i,a);if(c)for(var u=0,d=c.length;u<d;++u)if((s=c[u]).type===e.type&&s.name===e.name)return this.removeEventListener(s.type,s.listener,s.capture),this.addEventListener(s.type,s.listener=l,s.capture=n),void(s.value=t);this.addEventListener(e.type,l,n),s={type:e.type,name:e.name,value:t,listener:l,capture:n},c?c.push(s):this.__on=[s]}}function It(e,t,n){var r=$e(e),o=r.CustomEvent;"function"==typeof o?o=new o(t,n):(o=r.document.createEvent("Event"),n?(o.initEvent(t,n.bubbles,n.cancelable),o.detail=n.detail):o.initEvent(t,!1,!1)),e.dispatchEvent(o)}function At(e,t){return function(){return It(this,e,t)}}function Ot(e,t){return function(){return It(this,e,t.apply(this,arguments))}}var zt=[null];function Nt(e,t){this._groups=e,this._parents=t}function Dt(e,t,n){n&&n.drawStroke(e,t)}function jt(e,t,n){var r=e.ownerDocument.createElementNS("http://www.w3.org/2000/svg","_");switch(r.innerHTML=n,t.toLowerCase()){case"beforebegin":e.parentNode.insertBefore(r.firstChild,e);break;case"afterbegin":e.insertBefore(r.lastChild,e.firstChild);break;case"beforeend":e.appendChild(r.firstChild);break;case"afterend":e.parentNode.insertBefore(r.lastChild,e.nextSibling);break;default:l.warn("Invalid insertAdjacentHTML position")}}Nt.prototype=function(){return new Nt([[document.documentElement]],zt)}.prototype={constructor:Nt,select:function(e){"function"!=typeof e&&(e=He(e));for(var t=this._groups,n=t.length,r=new Array(n),o=0;o<n;++o)for(var i,a,s=t[o],c=s.length,l=r[o]=new Array(c),u=0;u<c;++u)(i=s[u])&&(a=e.call(i,i.__data__,u,s))&&("__data__"in i&&(a.__data__=i.__data__),l[u]=a);return new Nt(r,this._parents)},selectAll:function(e){"function"!=typeof e&&(e=function(e){return null==e?Xe:function(){return this.querySelectorAll(e)}}(e));for(var t=this._groups,n=t.length,r=[],o=[],i=0;i<n;++i)for(var a,s=t[i],c=s.length,l=0;l<c;++l)(a=s[l])&&(r.push(e.call(a,a.__data__,l,s)),o.push(a));return new Nt(r,o)},filter:function(e){"function"!=typeof e&&(e=function(e){return function(){return this.matches(e)}}(e));for(var t=this._groups,n=t.length,r=new Array(n),o=0;o<n;++o)for(var i,a=t[o],s=a.length,c=r[o]=[],l=0;l<s;++l)(i=a[l])&&e.call(i,i.__data__,l,a)&&c.push(i);return new Nt(r,this._parents)},data:function(e,t){if(!e)return f=new Array(this.size()),u=-1,this.each((function(e){f[++u]=e})),f;var n,r=t?Be:Ye,o=this._parents,i=this._groups;"function"!=typeof e&&(n=e,e=function(){return n});for(var a=i.length,s=new Array(a),c=new Array(a),l=new Array(a),u=0;u<a;++u){var d=o[u],p=i[u],h=p.length,f=e.call(d,d&&d.__data__,u,o),g=f.length,m=c[u]=new Array(g),v=s[u]=new Array(g);r(d,p,m,v,l[u]=new Array(h),f,t);for(var y,b,x=0,w=0;x<g;++x)if(y=m[x]){for(x>=w&&(w=x+1);!(b=v[w])&&++w<g;);y._next=b||null}}return(s=new Nt(s,o))._enter=c,s._exit=l,s},enter:function(){return new Nt(this._enter||this._groups.map(Ue),this._parents)},exit:function(){return new Nt(this._exit||this._groups.map(Ue),this._parents)},join:function(e,t,n){var r=this.enter(),o=this,i=this.exit();return r="function"==typeof e?e(r):r.append(e+""),null!=t&&(o=t(o)),null==n?i.remove():n(i),r&&o?r.merge(o).order():o},merge:function(e){for(var t=this._groups,n=e._groups,r=t.length,o=n.length,i=Math.min(r,o),a=new Array(r),s=0;s<i;++s)for(var c,l=t[s],u=n[s],d=l.length,p=a[s]=new Array(d),h=0;h<d;++h)(c=l[h]||u[h])&&(p[h]=c);for(;s<r;++s)a[s]=t[s];return new Nt(a,this._parents)},order:function(){for(var e=this._groups,t=-1,n=e.length;++t<n;)for(var r,o=e[t],i=o.length-1,a=o[i];--i>=0;)(r=o[i])&&(a&&4^r.compareDocumentPosition(a)&&a.parentNode.insertBefore(r,a),a=r);return this},sort:function(e){function t(t,n){return t&&n?e(t.__data__,n.__data__):!t-!n}e||(e=Ge);for(var n=this._groups,r=n.length,o=new Array(r),i=0;i<r;++i){for(var a,s=n[i],c=s.length,l=o[i]=new Array(c),u=0;u<c;++u)(a=s[u])&&(l[u]=a);l.sort(t)}return new Nt(o,this._parents).order()},call:function(){var e=arguments[0];return arguments[0]=this,e.apply(null,arguments),this},nodes:function(){var e=new Array(this.size()),t=-1;return this.each((function(){e[++t]=this})),e},node:function(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var r=e[t],o=0,i=r.length;o<i;++o){var a=r[o];if(a)return a}return null},size:function(){var e=0;return this.each((function(){++e})),e},empty:function(){return!this.node()},each:function(e){for(var t=this._groups,n=0,r=t.length;n<r;++n)for(var o,i=t[n],a=0,s=i.length;a<s;++a)(o=i[a])&&e.call(o,o.__data__,a,i);return this},attr:function(e,t){var n=Oe(e);if(arguments.length<2){var r=this.node();return n.local?r.getAttributeNS(n.space,n.local):r.getAttribute(n)}return this.each((null==t?n.local?Je:Fe:"function"==typeof t?n.local?Ze:qe:n.local?Ve:Ke)(n,t))},style:function(e,t,n){return arguments.length>1?this.each((null==t?Qe:"function"==typeof t?tt:et)(e,t,null==n?"":n)):nt(this.node(),e)},property:function(e,t){return arguments.length>1?this.each((null==t?rt:"function"==typeof t?it:ot)(e,t)):this.node()[e]},classed:function(e,t){var n=at(e+"");if(arguments.length<2){for(var r=st(this.node()),o=-1,i=n.length;++o<i;)if(!r.contains(n[o]))return!1;return!0}return this.each(("function"==typeof t?ht:t?dt:pt)(n,t))},text:function(e){return arguments.length?this.each(null==e?ft:("function"==typeof e?mt:gt)(e)):this.node().textContent},html:function(e){return arguments.length?this.each(null==e?vt:("function"==typeof e?bt:yt)(e)):this.node().innerHTML},raise:function(){return this.each(xt)},lower:function(){return this.each(wt)},append:function(e){var t="function"==typeof e?e:De(e);return this.select((function(){return this.appendChild(t.apply(this,arguments))}))},insert:function(e,t){var n="function"==typeof e?e:De(e),r=null==t?Et:"function"==typeof t?t:He(t);return this.select((function(){return this.insertBefore(n.apply(this,arguments),r.apply(this,arguments)||null)}))},remove:function(){return this.each(kt)},clone:function(e){return this.select(e?St:_t)},datum:function(e){return arguments.length?this.property("__data__",e):this.node().__data__},on:function(e,t,n){var r,o,i=Rt(e+""),a=i.length;if(!(arguments.length<2)){for(s=t?Mt:Lt,null==n&&(n=!1),r=0;r<a;++r)this.each(s(i[r],t,n));return this}var s=this.node().__on;if(s)for(var c,l=0,u=s.length;l<u;++l)for(r=0,c=s[l];r<a;++r)if((o=i[r]).type===c.type&&o.name===c.name)return c.value},dispatch:function(e,t){return this.each(("function"==typeof t?Ot:At)(e,t))}};var Ht=Object.freeze({__proto__:null,getInfo:function(){return{type:"svg"}},attach:function(e){var t=e;return l.debug("populate root element",t),t.style.fontSize="10px",function(e){return"string"==typeof e?new Nt([[document.querySelector(e)]],[document.documentElement]):new Nt([[e]],zt)}(t)},detach:function(e,t){l.debug("detach renderer",e),t.select("svg").remove()},resize:function(e,t,n,r,o){var i=e.node().getBoundingClientRect(),a=e.selectAll("svg"),s=i.width<o?o:i.width,c=i.height<r?r:i.height;return a.attr("viewBox","0 0 ".concat(s,", ").concat(c)),a.attr("width","".concat(s,"px")),a.attr("height","".concat(c,"px")),l.debug("svg viewBox changed",a),t},drawCurrentStroke:function(e,t,n){var r=t;return r.currentStroke.id="pendingStroke-".concat(t.rawStrokes.length),l.trace("drawing current stroke ",t.currentStroke),e.select("#pendingStrokes #".concat(r.currentStroke.id)).remove(),Dt(e.select("#pendingStrokes").append("path").attr("id",t.currentStroke.id),t.currentStroke,n),r},drawModel:function(e,t,n){var r=ge(t);r&&(r.forEach((function(t){var n;(n=t).updates.forEach((function(t){try{var r='svg[data-layer="'+n.layer+'"]';switch(t.type){case"REPLACE_ALL":e.select(r).remove();var o=e.node();o.insertAdjacentHTML?o.insertAdjacentHTML("beforeEnd",t.svg):jt(o,"beforeEnd",t.svg),"MODEL"===n.layer&&e.select(r).append("g").attr("id","pendingStrokes");break;case"REMOVE_ELEMENT":t.id.includes("s")||t.id.includes("MODEL")?e.select("#".concat(t.id)).remove():(e.select("#".concat(t.id)).attr("class","removed-stroke"),setTimeout((function(){e.select("#".concat(t.id)).remove()}),100));break;case"REPLACE_ELEMENT":var i=e.select("#".concat(t.id)).node().parentNode;e.select("#".concat(t.id)).remove(),i.insertAdjacentHTML?i.insertAdjacentHTML("beforeEnd",t.svg):(jt(i,"beforeEnd",t.svg),e.node().insertAdjacentHTML("beforeEnd",e.select(r).remove().node().outerHTML));break;case"REMOVE_CHILD":e.select("#".concat(t.parentId," > *:nth-child(").concat(t.index+1,")")).remove();break;case"APPEND_CHILD":var a=e.select(t.parentId?"#".concat(t.parentId):r).node();a.insertAdjacentHTML?a.insertAdjacentHTML("beforeEnd",t.svg):(jt(a,"beforeEnd",t.svg),e.node().insertAdjacentHTML("beforeEnd",e.select(r).remove().node().outerHTML));break;case"INSERT_BEFORE":var s=e.select("#".concat(t.refId)).node();s.insertAdjacentHTML?s.insertAdjacentHTML("beforeBegin",t.svg):(jt(s,"beforeBegin",t.svg),e.node().insertAdjacentHTML("beforeEnd",e.select(r).remove().node().outerHTML));break;case"REMOVE_ATTRIBUTE":e.selectAll(t.id?"#".concat(t.id):"svg").attr(t.name,null);break;case"SET_ATTRIBUTE":t.id&&e.selectAll("#".concat(t.id)).attr(t.name,t.value);break;default:l.debug("unknown update ".concat(t.type," action"))}}catch(e){l.error("Invalid update ".concat(t.type),t),l.error("Error on svg patch",e)}}))})),fe(t));var o=ae(t);return o&&o.forEach((function(t){return r=t,o=e.select("#pendingStrokes"),l.trace("attempting to draw ".concat(r.type," symbol")),void("stroke"!==r.type||o.select("id",r.id)?l.warn("impossible to draw ".concat(r.type," symbol")):Dt(o.append("path").attr("id",r.id),r,n));var r,o})),t}});function Xt(e,t,n){return["M ".concat(t.x,",").concat(t.y),"m ".concat(-n,",0"),"a ".concat(n,",").concat(n," 0 1 0 ").concat(2*n,",0"),"a ".concat(n,",").concat(n," 0 1 0 ").concat(-2*n,",0")].join(" ")}function Ut(e,t,n,r){var o=Se(t,Ce(t,n),r),i=Se(n,Ce(t,n),r);return["M ".concat(o[0].x,",").concat(o[0].y),"L ".concat(i[0].x,",").concat(i[0].y),"L ".concat(i[1].x,",").concat(i[1].y),"L ".concat(o[1].x,",").concat(o[1].y)].join(" ")}function Wt(e,t,n,r,o){var i=Se(t,Ce(t,r),o),a=Se(n,Ce(r,n),o),s=Se(r,Ce(t,n),o);return["M ".concat(i[0].x,",").concat(i[0].y),"Q ".concat(s[0].x,",").concat(s[0].y," ").concat(a[0].x,",").concat(a[0].y),"L ".concat(a[1].x,",").concat(a[1].y),"Q ".concat(s[1].x,",").concat(s[1].y," ").concat(i[1].x,",").concat(i[1].y)].join(" ")}var Yt=Object.freeze({__proto__:null,getInfo:function(){return{type:"svg",name:"quadratic"}},drawStroke:function(e,t){var n=t.x.length,r=t.width,o=J(t,0),i=n-2,a=[];if(n<3)a.push(Xt(0,o,.6*r));else{a.push(Xt(0,o,r*o.p)),a.push(Ut(0,o,Te(o,J(t,1)),r));for(var s=0;s<i;s++)a.push(Wt(0,Te(J(t,s),J(t,s+1)),Te(J(t,s+1),J(t,s+2)),J(t,s+1),r));a.push(Ut(0,Te(J(t,n-2),J(t,n-1)),J(t,n-1),r)),a.push(function(e,t,n,r){for(var o=Ce(t,n),i=Se(n,o,r),a=["M ".concat(i[0].x,",").concat(i[0].y)],s=1;s<=6;s++){var c=o-s*(Math.PI/6);a.push("L ".concat(n.x-n.p*r*Math.sin(c),",").concat(n.y+n.p*r*Math.cos(c)))}return a.join(" ")}(0,J(t,n-2),J(t,n-1),r))}var c=a.join(" ");e.attr("color",t.color).style("fill",t.color).style("stroke","transparent").classed("pending-stroke",!0).attr("d","".concat(c,"Z"))}}),Bt=o((function(e,t){var n;e.exports=(n=n||function(e,t){var n=Object.create||function(){function e(){}return function(t){var n;return e.prototype=t,n=new e,e.prototype=null,n}}(),r={},o=r.lib={},i=o.Base={extend:function(e){var t=n(this);return e&&t.mixIn(e),t.hasOwnProperty("init")&&this.init!==t.init||(t.init=function(){t.$super.init.apply(this,arguments)}),t.init.prototype=t,t.$super=this,t},create:function(){var e=this.extend();return e.init.apply(e,arguments),e},init:function(){},mixIn:function(e){for(var t in e)e.hasOwnProperty(t)&&(this[t]=e[t]);e.hasOwnProperty("toString")&&(this.toString=e.toString)},clone:function(){return this.init.prototype.extend(this)}},a=o.WordArray=i.extend({init:function(e,t){e=this.words=e||[],this.sigBytes=null!=t?t:4*e.length},toString:function(e){return(e||c).stringify(this)},concat:function(e){var t=this.words,n=e.words,r=this.sigBytes,o=e.sigBytes;if(this.clamp(),r%4)for(var i=0;i<o;i++){var a=n[i>>>2]>>>24-i%4*8&255;t[r+i>>>2]|=a<<24-(r+i)%4*8}else for(i=0;i<o;i+=4)t[r+i>>>2]=n[i>>>2];return this.sigBytes+=o,this},clamp:function(){var t=this.words,n=this.sigBytes;t[n>>>2]&=4294967295<<32-n%4*8,t.length=e.ceil(n/4)},clone:function(){var e=i.clone.call(this);return e.words=this.words.slice(0),e},random:function(t){for(var n,r=[],o=function(t){t=t;var n=987654321,r=4294967295;return function(){var o=((n=36969*(65535&n)+(n>>16)&r)<<16)+(t=18e3*(65535&t)+(t>>16)&r)&r;return o/=4294967296,(o+=.5)*(e.random()>.5?1:-1)}},i=0;i<t;i+=4){var s=o(4294967296*(n||e.random()));n=987654071*s(),r.push(4294967296*s()|0)}return new a.init(r,t)}}),s=r.enc={},c=s.Hex={stringify:function(e){for(var t=e.words,n=e.sigBytes,r=[],o=0;o<n;o++){var i=t[o>>>2]>>>24-o%4*8&255;r.push((i>>>4).toString(16)),r.push((15&i).toString(16))}return r.join("")},parse:function(e){for(var t=e.length,n=[],r=0;r<t;r+=2)n[r>>>3]|=parseInt(e.substr(r,2),16)<<24-r%8*4;return new a.init(n,t/2)}},l=s.Latin1={stringify:function(e){for(var t=e.words,n=e.sigBytes,r=[],o=0;o<n;o++){var i=t[o>>>2]>>>24-o%4*8&255;r.push(String.fromCharCode(i))}return r.join("")},parse:function(e){for(var t=e.length,n=[],r=0;r<t;r++)n[r>>>2]|=(255&e.charCodeAt(r))<<24-r%4*8;return new a.init(n,t)}},u=s.Utf8={stringify:function(e){try{return decodeURIComponent(escape(l.stringify(e)))}catch(e){throw new Error("Malformed UTF-8 data")}},parse:function(e){return l.parse(unescape(encodeURIComponent(e)))}},d=o.BufferedBlockAlgorithm=i.extend({reset:function(){this._data=new a.init,this._nDataBytes=0},_append:function(e){"string"==typeof e&&(e=u.parse(e)),this._data.concat(e),this._nDataBytes+=e.sigBytes},_process:function(t){var n=this._data,r=n.words,o=n.sigBytes,i=this.blockSize,s=o/(4*i),c=(s=t?e.ceil(s):e.max((0|s)-this._minBufferSize,0))*i,l=e.min(4*c,o);if(c){for(var u=0;u<c;u+=i)this._doProcessBlock(r,u);var d=r.splice(0,c);n.sigBytes-=l}return new a.init(d,l)},clone:function(){var e=i.clone.call(this);return e._data=this._data.clone(),e},_minBufferSize:0}),p=(o.Hasher=d.extend({cfg:i.extend(),init:function(e){this.cfg=this.cfg.extend(e),this.reset()},reset:function(){d.reset.call(this),this._doReset()},update:function(e){return this._append(e),this._process(),this},finalize:function(e){return e&&this._append(e),this._doFinalize()},blockSize:16,_createHelper:function(e){return function(t,n){return new e.init(n).finalize(t)}},_createHmacHelper:function(e){return function(t,n){return new p.HMAC.init(e,n).finalize(t)}}}),r.algo={});return r}(Math),n)})),Gt=o((function(e,t){e.exports=Bt.enc.Hex})),Ft=(o((function(e,t){var n,r,o,i,a,s;e.exports=(r=(n=s=Bt).lib,o=r.Base,i=r.WordArray,(a=n.x64={}).Word=o.extend({init:function(e,t){this.high=e,this.low=t}}),a.WordArray=o.extend({init:function(e,t){e=this.words=e||[],this.sigBytes=null!=t?t:8*e.length},toX32:function(){for(var e=this.words,t=e.length,n=[],r=0;r<t;r++){var o=e[r];n.push(o.high),n.push(o.low)}return i.create(n,this.sigBytes)},clone:function(){for(var e=o.clone.call(this),t=e.words=this.words.slice(0),n=t.length,r=0;r<n;r++)t[r]=t[r].clone();return e}}),s)})),o((function(e,t){var n;e.exports=(n=Bt,function(){var e=n,t=e.lib.Hasher,r=e.x64,o=r.Word,i=r.WordArray,a=e.algo;function s(){return o.create.apply(o,arguments)}var c=[s(1116352408,3609767458),s(1899447441,602891725),s(3049323471,3964484399),s(3921009573,2173295548),s(961987163,4081628472),s(1508970993,3053834265),s(2453635748,2937671579),s(2870763221,3664609560),s(3624381080,2734883394),s(310598401,1164996542),s(607225278,1323610764),s(1426881987,3590304994),s(1925078388,4068182383),s(2162078206,991336113),s(2614888103,633803317),s(3248222580,3479774868),s(3835390401,2666613458),s(4022224774,944711139),s(264347078,2341262773),s(604807628,2007800933),s(770255983,1495990901),s(1249150122,1856431235),s(1555081692,3175218132),s(1996064986,2198950837),s(2554220882,3999719339),s(2821834349,766784016),s(2952996808,2566594879),s(3210313671,3203337956),s(3336571891,1034457026),s(3584528711,2466948901),s(113926993,3758326383),s(338241895,168717936),s(666307205,1188179964),s(773529912,1546045734),s(1294757372,1522805485),s(1396182291,2643833823),s(1695183700,2343527390),s(1986661051,1014477480),s(2177026350,1206759142),s(2456956037,344077627),s(2730485921,1290863460),s(2820302411,3158454273),s(3259730800,3505952657),s(3345764771,106217008),s(3516065817,3606008344),s(3600352804,1432725776),s(4094571909,1467031594),s(275423344,851169720),s(430227734,3100823752),s(506948616,1363258195),s(659060556,3750685593),s(883997877,3785050280),s(958139571,3318307427),s(1322822218,3812723403),s(1537002063,2003034995),s(1747873779,3602036899),s(1955562222,1575990012),s(2024104815,1125592928),s(2227730452,2716904306),s(2361852424,442776044),s(2428436474,593698344),s(2756734187,3733110249),s(3204031479,2999351573),s(3329325298,3815920427),s(3391569614,3928383900),s(3515267271,566280711),s(3940187606,3454069534),s(4118630271,4000239992),s(116418474,1914138554),s(174292421,2731055270),s(289380356,3203993006),s(460393269,320620315),s(685471733,587496836),s(852142971,1086792851),s(1017036298,365543100),s(1126000580,2618297676),s(1288033470,3409855158),s(1501505948,4234509866),s(1607167915,987167468),s(1816402316,1246189591)],l=[];!function(){for(var e=0;e<80;e++)l[e]=s()}();var u=a.SHA512=t.extend({_doReset:function(){this._hash=new i.init([new o.init(1779033703,4089235720),new o.init(3144134277,2227873595),new o.init(1013904242,4271175723),new o.init(2773480762,1595750129),new o.init(1359893119,2917565137),new o.init(2600822924,725511199),new o.init(528734635,4215389547),new o.init(1541459225,327033209)])},_doProcessBlock:function(e,t){for(var n=this._hash.words,r=n[0],o=n[1],i=n[2],a=n[3],s=n[4],u=n[5],d=n[6],p=n[7],h=r.high,f=r.low,g=o.high,m=o.low,v=i.high,y=i.low,b=a.high,x=a.low,w=s.high,E=s.low,k=u.high,_=u.low,S=d.high,T=d.low,C=p.high,P=p.low,R=h,L=f,M=g,I=m,A=v,O=y,z=b,N=x,D=w,j=E,H=k,X=_,U=S,W=T,Y=C,B=P,G=0;G<80;G++){var F=l[G];if(G<16)var J=F.high=0|e[t+2*G],K=F.low=0|e[t+2*G+1];else{var V=l[G-15],q=V.high,Z=V.low,$=(q>>>1|Z<<31)^(q>>>8|Z<<24)^q>>>7,Q=(Z>>>1|q<<31)^(Z>>>8|q<<24)^(Z>>>7|q<<25),ee=l[G-2],te=ee.high,ne=ee.low,re=(te>>>19|ne<<13)^(te<<3|ne>>>29)^te>>>6,oe=(ne>>>19|te<<13)^(ne<<3|te>>>29)^(ne>>>6|te<<26),ie=l[G-7],ae=ie.high,se=ie.low,ce=l[G-16],le=ce.high,ue=ce.low;J=(J=(J=$+ae+((K=Q+se)>>>0<Q>>>0?1:0))+re+((K+=oe)>>>0<oe>>>0?1:0))+le+((K+=ue)>>>0<ue>>>0?1:0),F.high=J,F.low=K}var de,pe=D&H^~D&U,he=j&X^~j&W,fe=R&M^R&A^M&A,ge=L&I^L&O^I&O,me=(R>>>28|L<<4)^(R<<30|L>>>2)^(R<<25|L>>>7),ve=(L>>>28|R<<4)^(L<<30|R>>>2)^(L<<25|R>>>7),ye=(D>>>14|j<<18)^(D>>>18|j<<14)^(D<<23|j>>>9),be=(j>>>14|D<<18)^(j>>>18|D<<14)^(j<<23|D>>>9),xe=c[G],we=xe.high,Ee=xe.low,ke=Y+ye+((de=B+be)>>>0<B>>>0?1:0),_e=ve+ge;Y=U,B=W,U=H,W=X,H=D,X=j,D=z+(ke=(ke=(ke=ke+pe+((de+=he)>>>0<he>>>0?1:0))+we+((de+=Ee)>>>0<Ee>>>0?1:0))+J+((de+=K)>>>0<K>>>0?1:0))+((j=N+de|0)>>>0<N>>>0?1:0)|0,z=A,N=O,A=M,O=I,M=R,I=L,R=ke+(me+fe+(_e>>>0<ve>>>0?1:0))+((L=de+_e|0)>>>0<de>>>0?1:0)|0}f=r.low=f+L,r.high=h+R+(f>>>0<L>>>0?1:0),m=o.low=m+I,o.high=g+M+(m>>>0<I>>>0?1:0),y=i.low=y+O,i.high=v+A+(y>>>0<O>>>0?1:0),x=a.low=x+N,a.high=b+z+(x>>>0<N>>>0?1:0),E=s.low=E+j,s.high=w+D+(E>>>0<j>>>0?1:0),_=u.low=_+X,u.high=k+H+(_>>>0<X>>>0?1:0),T=d.low=T+W,d.high=S+U+(T>>>0<W>>>0?1:0),P=p.low=P+B,p.high=C+Y+(P>>>0<B>>>0?1:0)},_doFinalize:function(){var e=this._data,t=e.words,n=8*this._nDataBytes,r=8*e.sigBytes;return t[r>>>5]|=128<<24-r%32,t[30+(r+128>>>10<<5)]=Math.floor(n/4294967296),t[31+(r+128>>>10<<5)]=n,e.sigBytes=4*t.length,this._process(),this._hash.toX32()},clone:function(){var e=t.clone.call(this);return e._hash=this._hash.clone(),e},blockSize:32});e.SHA512=t._createHelper(u),e.HmacSHA512=t._createHmacHelper(u)}(),n.SHA512)})),o((function(e,t){var n,r,o;e.exports=(r=(n=Bt).lib.Base,o=n.enc.Utf8,void(n.algo.HMAC=r.extend({init:function(e,t){e=this._hasher=new e.init,"string"==typeof t&&(t=o.parse(t));var n=e.blockSize,r=4*n;t.sigBytes>r&&(t=e.finalize(t)),t.clamp();for(var i=this._oKey=t.clone(),a=this._iKey=t.clone(),s=i.words,c=a.words,l=0;l<n;l++)s[l]^=1549556828,c[l]^=909522486;i.sigBytes=a.sigBytes=r,this.reset()},reset:function(){var e=this._hasher;e.reset(),e.update(this._iKey)},update:function(e){return this._hasher.update(e),this},finalize:function(e){var t=this._hasher,n=t.finalize(e);return t.reset(),t.finalize(this._oKey.clone().concat(n))}})))})),o((function(e,t){e.exports=Bt.HmacSHA512})));function Jt(e,t,n){var r="object"===S(e)?JSON.stringify(e):e;return u.debug("The HmacSHA512 function is loaded",Ft),new Ft(r,t+n).toString(Gt)}function Kt(e){var t;try{t=JSON.parse(e.responseText)}catch(n){t=e.responseText}return t}function Vt(e,t,n,r,o){return function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},o=arguments.length>5?arguments[5]:void 0,i="application/vnd.openxmlformats-officedocument.presentationml.presentation",a=r.editor.configuration,s=r;return new Promise((function(r,c){var l=new XMLHttpRequest;switch(l.open(e,t,!0),l.withCredentials=!0,a.recognitionParams.type){case"TEXT":case"MATH":case"DIAGRAM":case"Raw Content":l.setRequestHeader("Accept","application/json,"+o)}l.setRequestHeader("applicationKey",a.recognitionParams.server.applicationKey),l.setRequestHeader("hmac",Jt(JSON.stringify(n),a.recognitionParams.server.applicationKey,a.recognitionParams.server.hmacKey)),l.setRequestHeader("Content-Type","application/json");var u=o&&(o===i||o.startsWith("image/png")||o.startsWith("image/jpeg"));u&&(l.responseType="blob"),l.onerror=function(){c({msg:"Could not connect to ".concat(t," connection error"),recoverable:!1})},l.onload=function(){l.status>=200&&l.status<300?r(u?l.response:Kt(l)):c(new Error(l.responseText))},l.onreadystatechange=function(){4===l.readyState&&l.status>=200&&l.status<300&&r(u?l.response:Kt(l))},s&&(s.idle=!1),l.send(JSON.stringify(n))})).then((function(e){return s&&(s.idle=!0),e}))}("POST",t,n,e,r,o)}function qt(e){var t=Date.now();return u.info("Create empty recognizer context with ID: "+t),{id:t,editor:e,recognitionContexts:[],initPromise:void 0,lastPositions:{lastSentPosition:-1,lastReceivedPosition:-1},url:void 0,websocket:void 0,websocketCallback:void 0,reconnect:void 0,currentReconnectionCount:0,sessionId:void 0,contentPartCount:0,currentPartId:void 0,instanceId:void 0,canUndo:!1,canRedo:!1,isEmpty:void 0,supportedImportMimeTypes:[],undoStackIndex:0,possibleUndoCount:0,idle:!0,initialized:!1}}function Zt(e,t){return!!e.lastPositions&&e.lastPositions.lastSentPosition>=t.rawStrokes.length-1}function $t(e,t){var n=e;return t&&(n.lastPositions.lastSentPosition=t.lastSentPosition,n.lastPositions.lastReceivedPosition=t.lastReceivedPosition),n.lastPositions.lastSentPosition===n.lastPositions.lastReceivedPosition===-1&&delete n.instanceId,n}function Qt(e,t){var n=e;return n.recognitionContexts[0]=t,n}function en(e){return!0===e.websocket.autoReconnect&&e.currentReconnectionCount<=e.websocket.maxRetryCount}function tn(e){var t=e;return!0===t.websocket.autoReconnect&&t.currentReconnectionCount++<=t.websocket.maxRetryCount}var nn={type:"LOST_CONNECTION"},rn=Object.freeze({__proto__:null,createEmptyRecognizerContext:qt,isResetRequired:Zt,updateRecognitionPositions:$t,setRecognitionContext:Qt,canReconnect:en,shouldAttemptImmediateReconnect:tn,LOST_CONNEXION_MESSAGE:nn,CLOSE_RECOGNIZER_MESSAGE:"CLOSE_RECOGNIZER"});
/*!
   * perfect-scrollbar v1.5.0
   * Copyright 2020 Hyunje Jun, MDBootstrap and Contributors
   * Licensed under MIT
   */
function on(e){return getComputedStyle(e)}function an(e,t){for(var n in t){var r=t[n];"number"==typeof r&&(r+="px"),e.style[n]=r}return e}function sn(e){var t=document.createElement("div");return t.className=e,t}var cn="undefined"!=typeof Element&&(Element.prototype.matches||Element.prototype.webkitMatchesSelector||Element.prototype.mozMatchesSelector||Element.prototype.msMatchesSelector);function ln(e,t){if(!cn)throw new Error("No element matching method supported");return cn.call(e,t)}function un(e){e.remove?e.remove():e.parentNode&&e.parentNode.removeChild(e)}function dn(e,t){return Array.prototype.filter.call(e.children,(function(e){return ln(e,t)}))}var pn="ps",hn="ps__rtl",fn={thumb:function(e){return"ps__thumb-"+e},rail:function(e){return"ps__rail-"+e},consuming:"ps__child--consume"},gn={focus:"ps--focus",clicking:"ps--clicking",active:function(e){return"ps--active-"+e},scrolling:function(e){return"ps--scrolling-"+e}},mn={x:null,y:null};function vn(e,t){var n=e.element.classList,r=gn.scrolling(t);n.contains(r)?clearTimeout(mn[t]):n.add(r)}function yn(e,t){mn[t]=setTimeout((function(){return e.isAlive&&e.element.classList.remove(gn.scrolling(t))}),e.settings.scrollingThreshold)}var bn=function(e){this.element=e,this.handlers={}},xn={isEmpty:{configurable:!0}};bn.prototype.bind=function(e,t){void 0===this.handlers[e]&&(this.handlers[e]=[]),this.handlers[e].push(t),this.element.addEventListener(e,t,!1)},bn.prototype.unbind=function(e,t){var n=this;this.handlers[e]=this.handlers[e].filter((function(r){return!(!t||r===t)||(n.element.removeEventListener(e,r,!1),!1)}))},bn.prototype.unbindAll=function(){for(var e in this.handlers)this.unbind(e)},xn.isEmpty.get=function(){var e=this;return Object.keys(this.handlers).every((function(t){return 0===e.handlers[t].length}))},Object.defineProperties(bn.prototype,xn);var wn=function(){this.eventElements=[]};function En(e){if("function"==typeof window.CustomEvent)return new CustomEvent(e);var t=document.createEvent("CustomEvent");return t.initCustomEvent(e,!1,!1,void 0),t}function kn(e,t,n,r,o){var i;if(void 0===r&&(r=!0),void 0===o&&(o=!1),"top"===t)i=["contentHeight","containerHeight","scrollTop","y","up","down"];else{if("left"!==t)throw new Error("A proper axis should be provided");i=["contentWidth","containerWidth","scrollLeft","x","left","right"]}!function(e,t,n,r,o){var i=n[0],a=n[1],s=n[2],c=n[3],l=n[4],u=n[5];void 0===r&&(r=!0);void 0===o&&(o=!1);var d=e.element;e.reach[c]=null,d[s]<1&&(e.reach[c]="start");d[s]>e[i]-e[a]-1&&(e.reach[c]="end");t&&(d.dispatchEvent(En("ps-scroll-"+c)),t<0?d.dispatchEvent(En("ps-scroll-"+l)):t>0&&d.dispatchEvent(En("ps-scroll-"+u)),r&&function(e,t){vn(e,t),yn(e,t)}(e,c));e.reach[c]&&(t||o)&&d.dispatchEvent(En("ps-"+c+"-reach-"+e.reach[c]))}(e,n,i,r,o)}function _n(e){return parseInt(e,10)||0}wn.prototype.eventElement=function(e){var t=this.eventElements.filter((function(t){return t.element===e}))[0];return t||(t=new bn(e),this.eventElements.push(t)),t},wn.prototype.bind=function(e,t,n){this.eventElement(e).bind(t,n)},wn.prototype.unbind=function(e,t,n){var r=this.eventElement(e);r.unbind(t,n),r.isEmpty&&this.eventElements.splice(this.eventElements.indexOf(r),1)},wn.prototype.unbindAll=function(){this.eventElements.forEach((function(e){return e.unbindAll()})),this.eventElements=[]},wn.prototype.once=function(e,t,n){var r=this.eventElement(e),o=function(e){r.unbind(t,o),n(e)};r.bind(t,o)};var Sn={isWebKit:"undefined"!=typeof document&&"WebkitAppearance"in document.documentElement.style,supportsTouch:"undefined"!=typeof window&&("ontouchstart"in window||"maxTouchPoints"in window.navigator&&window.navigator.maxTouchPoints>0||window.DocumentTouch&&document instanceof window.DocumentTouch),supportsIePointer:"undefined"!=typeof navigator&&navigator.msMaxTouchPoints,isChrome:"undefined"!=typeof navigator&&/Chrome/i.test(navigator&&navigator.userAgent)};function Tn(e){var t=e.element,n=Math.floor(t.scrollTop),r=t.getBoundingClientRect();e.containerWidth=Math.ceil(r.width),e.containerHeight=Math.ceil(r.height),e.contentWidth=t.scrollWidth,e.contentHeight=t.scrollHeight,t.contains(e.scrollbarXRail)||(dn(t,fn.rail("x")).forEach((function(e){return un(e)})),t.appendChild(e.scrollbarXRail)),t.contains(e.scrollbarYRail)||(dn(t,fn.rail("y")).forEach((function(e){return un(e)})),t.appendChild(e.scrollbarYRail)),!e.settings.suppressScrollX&&e.containerWidth+e.settings.scrollXMarginOffset<e.contentWidth?(e.scrollbarXActive=!0,e.railXWidth=e.containerWidth-e.railXMarginWidth,e.railXRatio=e.containerWidth/e.railXWidth,e.scrollbarXWidth=Cn(e,_n(e.railXWidth*e.containerWidth/e.contentWidth)),e.scrollbarXLeft=_n((e.negativeScrollAdjustment+t.scrollLeft)*(e.railXWidth-e.scrollbarXWidth)/(e.contentWidth-e.containerWidth))):e.scrollbarXActive=!1,!e.settings.suppressScrollY&&e.containerHeight+e.settings.scrollYMarginOffset<e.contentHeight?(e.scrollbarYActive=!0,e.railYHeight=e.containerHeight-e.railYMarginHeight,e.railYRatio=e.containerHeight/e.railYHeight,e.scrollbarYHeight=Cn(e,_n(e.railYHeight*e.containerHeight/e.contentHeight)),e.scrollbarYTop=_n(n*(e.railYHeight-e.scrollbarYHeight)/(e.contentHeight-e.containerHeight))):e.scrollbarYActive=!1,e.scrollbarXLeft>=e.railXWidth-e.scrollbarXWidth&&(e.scrollbarXLeft=e.railXWidth-e.scrollbarXWidth),e.scrollbarYTop>=e.railYHeight-e.scrollbarYHeight&&(e.scrollbarYTop=e.railYHeight-e.scrollbarYHeight),function(e,t){var n={width:t.railXWidth},r=Math.floor(e.scrollTop);t.isRtl?n.left=t.negativeScrollAdjustment+e.scrollLeft+t.containerWidth-t.contentWidth:n.left=e.scrollLeft;t.isScrollbarXUsingBottom?n.bottom=t.scrollbarXBottom-r:n.top=t.scrollbarXTop+r;an(t.scrollbarXRail,n);var o={top:r,height:t.railYHeight};t.isScrollbarYUsingRight?t.isRtl?o.right=t.contentWidth-(t.negativeScrollAdjustment+e.scrollLeft)-t.scrollbarYRight-t.scrollbarYOuterWidth-9:o.right=t.scrollbarYRight-e.scrollLeft:t.isRtl?o.left=t.negativeScrollAdjustment+e.scrollLeft+2*t.containerWidth-t.contentWidth-t.scrollbarYLeft-t.scrollbarYOuterWidth:o.left=t.scrollbarYLeft+e.scrollLeft;an(t.scrollbarYRail,o),an(t.scrollbarX,{left:t.scrollbarXLeft,width:t.scrollbarXWidth-t.railBorderXWidth}),an(t.scrollbarY,{top:t.scrollbarYTop,height:t.scrollbarYHeight-t.railBorderYWidth})}(t,e),e.scrollbarXActive?t.classList.add(gn.active("x")):(t.classList.remove(gn.active("x")),e.scrollbarXWidth=0,e.scrollbarXLeft=0,t.scrollLeft=!0===e.isRtl?e.contentWidth:0),e.scrollbarYActive?t.classList.add(gn.active("y")):(t.classList.remove(gn.active("y")),e.scrollbarYHeight=0,e.scrollbarYTop=0,t.scrollTop=0)}function Cn(e,t){return e.settings.minScrollbarLength&&(t=Math.max(t,e.settings.minScrollbarLength)),e.settings.maxScrollbarLength&&(t=Math.min(t,e.settings.maxScrollbarLength)),t}function Pn(e,t){var n=t[0],r=t[1],o=t[2],i=t[3],a=t[4],s=t[5],c=t[6],l=t[7],u=t[8],d=e.element,p=null,h=null,f=null;function g(t){t.touches&&t.touches[0]&&(t[o]=t.touches[0].pageY),d[c]=p+f*(t[o]-h),vn(e,l),Tn(e),t.stopPropagation(),t.preventDefault()}function m(){yn(e,l),e[u].classList.remove(gn.clicking),e.event.unbind(e.ownerDocument,"mousemove",g)}function v(t,a){p=d[c],a&&t.touches&&(t[o]=t.touches[0].pageY),h=t[o],f=(e[r]-e[n])/(e[i]-e[s]),a?e.event.bind(e.ownerDocument,"touchmove",g):(e.event.bind(e.ownerDocument,"mousemove",g),e.event.once(e.ownerDocument,"mouseup",m),t.preventDefault()),e[u].classList.add(gn.clicking),t.stopPropagation()}e.event.bind(e[a],"mousedown",(function(e){v(e)})),e.event.bind(e[a],"touchstart",(function(e){v(e,!0)}))}var Rn={"click-rail":function(e){e.element,e.event.bind(e.scrollbarY,"mousedown",(function(e){return e.stopPropagation()})),e.event.bind(e.scrollbarYRail,"mousedown",(function(t){var n=t.pageY-window.pageYOffset-e.scrollbarYRail.getBoundingClientRect().top>e.scrollbarYTop?1:-1;e.element.scrollTop+=n*e.containerHeight,Tn(e),t.stopPropagation()})),e.event.bind(e.scrollbarX,"mousedown",(function(e){return e.stopPropagation()})),e.event.bind(e.scrollbarXRail,"mousedown",(function(t){var n=t.pageX-window.pageXOffset-e.scrollbarXRail.getBoundingClientRect().left>e.scrollbarXLeft?1:-1;e.element.scrollLeft+=n*e.containerWidth,Tn(e),t.stopPropagation()}))},"drag-thumb":function(e){Pn(e,["containerWidth","contentWidth","pageX","railXWidth","scrollbarX","scrollbarXWidth","scrollLeft","x","scrollbarXRail"]),Pn(e,["containerHeight","contentHeight","pageY","railYHeight","scrollbarY","scrollbarYHeight","scrollTop","y","scrollbarYRail"])},keyboard:function(e){var t=e.element;e.event.bind(e.ownerDocument,"keydown",(function(n){if(!(n.isDefaultPrevented&&n.isDefaultPrevented()||n.defaultPrevented)&&(ln(t,":hover")||ln(e.scrollbarX,":focus")||ln(e.scrollbarY,":focus"))){var r,o=document.activeElement?document.activeElement:e.ownerDocument.activeElement;if(o){if("IFRAME"===o.tagName)o=o.contentDocument.activeElement;else for(;o.shadowRoot;)o=o.shadowRoot.activeElement;if(ln(r=o,"input,[contenteditable]")||ln(r,"select,[contenteditable]")||ln(r,"textarea,[contenteditable]")||ln(r,"button,[contenteditable]"))return}var i=0,a=0;switch(n.which){case 37:i=n.metaKey?-e.contentWidth:n.altKey?-e.containerWidth:-30;break;case 38:a=n.metaKey?e.contentHeight:n.altKey?e.containerHeight:30;break;case 39:i=n.metaKey?e.contentWidth:n.altKey?e.containerWidth:30;break;case 40:a=n.metaKey?-e.contentHeight:n.altKey?-e.containerHeight:-30;break;case 32:a=n.shiftKey?e.containerHeight:-e.containerHeight;break;case 33:a=e.containerHeight;break;case 34:a=-e.containerHeight;break;case 36:a=e.contentHeight;break;case 35:a=-e.contentHeight;break;default:return}e.settings.suppressScrollX&&0!==i||e.settings.suppressScrollY&&0!==a||(t.scrollTop-=a,t.scrollLeft+=i,Tn(e),function(n,r){var o=Math.floor(t.scrollTop);if(0===n){if(!e.scrollbarYActive)return!1;if(0===o&&r>0||o>=e.contentHeight-e.containerHeight&&r<0)return!e.settings.wheelPropagation}var i=t.scrollLeft;if(0===r){if(!e.scrollbarXActive)return!1;if(0===i&&n<0||i>=e.contentWidth-e.containerWidth&&n>0)return!e.settings.wheelPropagation}return!0}(i,a)&&n.preventDefault())}}))},wheel:function(e){var t=e.element;function n(n){var r=function(e){var t=e.deltaX,n=-1*e.deltaY;return void 0!==t&&void 0!==n||(t=-1*e.wheelDeltaX/6,n=e.wheelDeltaY/6),e.deltaMode&&1===e.deltaMode&&(t*=10,n*=10),t!=t&&n!=n&&(t=0,n=e.wheelDelta),e.shiftKey?[-n,-t]:[t,n]}(n),o=r[0],i=r[1];if(!function(e,n,r){if(!Sn.isWebKit&&t.querySelector("select:focus"))return!0;if(!t.contains(e))return!1;for(var o=e;o&&o!==t;){if(o.classList.contains(fn.consuming))return!0;var i=on(o);if(r&&i.overflowY.match(/(scroll|auto)/)){var a=o.scrollHeight-o.clientHeight;if(a>0&&(o.scrollTop>0&&r<0||o.scrollTop<a&&r>0))return!0}if(n&&i.overflowX.match(/(scroll|auto)/)){var s=o.scrollWidth-o.clientWidth;if(s>0&&(o.scrollLeft>0&&n<0||o.scrollLeft<s&&n>0))return!0}o=o.parentNode}return!1}(n.target,o,i)){var a=!1;e.settings.useBothWheelAxes?e.scrollbarYActive&&!e.scrollbarXActive?(i?t.scrollTop-=i*e.settings.wheelSpeed:t.scrollTop+=o*e.settings.wheelSpeed,a=!0):e.scrollbarXActive&&!e.scrollbarYActive&&(o?t.scrollLeft+=o*e.settings.wheelSpeed:t.scrollLeft-=i*e.settings.wheelSpeed,a=!0):(t.scrollTop-=i*e.settings.wheelSpeed,t.scrollLeft+=o*e.settings.wheelSpeed),Tn(e),(a=a||function(n,r){var o=Math.floor(t.scrollTop),i=0===t.scrollTop,a=o+t.offsetHeight===t.scrollHeight,s=0===t.scrollLeft,c=t.scrollLeft+t.offsetWidth===t.scrollWidth;return!(Math.abs(r)>Math.abs(n)?i||a:s||c)||!e.settings.wheelPropagation}(o,i))&&!n.ctrlKey&&(n.stopPropagation(),n.preventDefault())}}void 0!==window.onwheel?e.event.bind(t,"wheel",n):void 0!==window.onmousewheel&&e.event.bind(t,"mousewheel",n)},touch:function(e){if(Sn.supportsTouch||Sn.supportsIePointer){var t=e.element,n={},r=0,o={},i=null;Sn.supportsTouch?(e.event.bind(t,"touchstart",l),e.event.bind(t,"touchmove",u),e.event.bind(t,"touchend",d)):Sn.supportsIePointer&&(window.PointerEvent?(e.event.bind(t,"pointerdown",l),e.event.bind(t,"pointermove",u),e.event.bind(t,"pointerup",d)):window.MSPointerEvent&&(e.event.bind(t,"MSPointerDown",l),e.event.bind(t,"MSPointerMove",u),e.event.bind(t,"MSPointerUp",d)))}function a(n,r){t.scrollTop-=r,t.scrollLeft-=n,Tn(e)}function s(e){return e.targetTouches?e.targetTouches[0]:e}function c(e){return(!e.pointerType||"pen"!==e.pointerType||0!==e.buttons)&&(!(!e.targetTouches||1!==e.targetTouches.length)||!(!e.pointerType||"mouse"===e.pointerType||e.pointerType===e.MSPOINTER_TYPE_MOUSE))}function l(e){if(c(e)){var t=s(e);n.pageX=t.pageX,n.pageY=t.pageY,r=(new Date).getTime(),null!==i&&clearInterval(i)}}function u(i){if(c(i)){var l=s(i),u={pageX:l.pageX,pageY:l.pageY},d=u.pageX-n.pageX,p=u.pageY-n.pageY;if(function(e,n,r){if(!t.contains(e))return!1;for(var o=e;o&&o!==t;){if(o.classList.contains(fn.consuming))return!0;var i=on(o);if(r&&i.overflowY.match(/(scroll|auto)/)){var a=o.scrollHeight-o.clientHeight;if(a>0&&(o.scrollTop>0&&r<0||o.scrollTop<a&&r>0))return!0}if(n&&i.overflowX.match(/(scroll|auto)/)){var s=o.scrollWidth-o.clientWidth;if(s>0&&(o.scrollLeft>0&&n<0||o.scrollLeft<s&&n>0))return!0}o=o.parentNode}return!1}(i.target,d,p))return;a(d,p),n=u;var h=(new Date).getTime(),f=h-r;f>0&&(o.x=d/f,o.y=p/f,r=h),function(n,r){var o=Math.floor(t.scrollTop),i=t.scrollLeft,a=Math.abs(n),s=Math.abs(r);if(s>a){if(r<0&&o===e.contentHeight-e.containerHeight||r>0&&0===o)return 0===window.scrollY&&r>0&&Sn.isChrome}else if(a>s&&(n<0&&i===e.contentWidth-e.containerWidth||n>0&&0===i))return!0;return!0}(d,p)&&i.preventDefault()}}function d(){e.settings.swipeEasing&&(clearInterval(i),i=setInterval((function(){e.isInitialized?clearInterval(i):o.x||o.y?Math.abs(o.x)<.01&&Math.abs(o.y)<.01?clearInterval(i):(a(30*o.x,30*o.y),o.x*=.8,o.y*=.8):clearInterval(i)}),10))}}},Ln=function(e,t){var n=this;if(void 0===t&&(t={}),"string"==typeof e&&(e=document.querySelector(e)),!e||!e.nodeName)throw new Error("no element is specified to initialize PerfectScrollbar");for(var r in this.element=e,e.classList.add(pn),this.settings={handlers:["click-rail","drag-thumb","keyboard","wheel","touch"],maxScrollbarLength:null,minScrollbarLength:null,scrollingThreshold:1e3,scrollXMarginOffset:0,scrollYMarginOffset:0,suppressScrollX:!1,suppressScrollY:!1,swipeEasing:!0,useBothWheelAxes:!1,wheelPropagation:!0,wheelSpeed:1},t)this.settings[r]=t[r];this.containerWidth=null,this.containerHeight=null,this.contentWidth=null,this.contentHeight=null;var o=function(){return e.classList.add(gn.focus)},i=function(){return e.classList.remove(gn.focus)};this.isRtl="rtl"===on(e).direction,!0===this.isRtl&&e.classList.add(hn),this.isNegativeScroll=function(){var t,n=e.scrollLeft;return e.scrollLeft=-1,t=e.scrollLeft<0,e.scrollLeft=n,t}(),this.negativeScrollAdjustment=this.isNegativeScroll?e.scrollWidth-e.clientWidth:0,this.event=new wn,this.ownerDocument=e.ownerDocument||document,this.scrollbarXRail=sn(fn.rail("x")),e.appendChild(this.scrollbarXRail),this.scrollbarX=sn(fn.thumb("x")),this.scrollbarXRail.appendChild(this.scrollbarX),this.scrollbarX.setAttribute("tabindex",0),this.event.bind(this.scrollbarX,"focus",o),this.event.bind(this.scrollbarX,"blur",i),this.scrollbarXActive=null,this.scrollbarXWidth=null,this.scrollbarXLeft=null;var a=on(this.scrollbarXRail);this.scrollbarXBottom=parseInt(a.bottom,10),isNaN(this.scrollbarXBottom)?(this.isScrollbarXUsingBottom=!1,this.scrollbarXTop=_n(a.top)):this.isScrollbarXUsingBottom=!0,this.railBorderXWidth=_n(a.borderLeftWidth)+_n(a.borderRightWidth),an(this.scrollbarXRail,{display:"block"}),this.railXMarginWidth=_n(a.marginLeft)+_n(a.marginRight),an(this.scrollbarXRail,{display:""}),this.railXWidth=null,this.railXRatio=null,this.scrollbarYRail=sn(fn.rail("y")),e.appendChild(this.scrollbarYRail),this.scrollbarY=sn(fn.thumb("y")),this.scrollbarYRail.appendChild(this.scrollbarY),this.scrollbarY.setAttribute("tabindex",0),this.event.bind(this.scrollbarY,"focus",o),this.event.bind(this.scrollbarY,"blur",i),this.scrollbarYActive=null,this.scrollbarYHeight=null,this.scrollbarYTop=null;var s=on(this.scrollbarYRail);this.scrollbarYRight=parseInt(s.right,10),isNaN(this.scrollbarYRight)?(this.isScrollbarYUsingRight=!1,this.scrollbarYLeft=_n(s.left)):this.isScrollbarYUsingRight=!0,this.scrollbarYOuterWidth=this.isRtl?function(e){var t=on(e);return _n(t.width)+_n(t.paddingLeft)+_n(t.paddingRight)+_n(t.borderLeftWidth)+_n(t.borderRightWidth)}(this.scrollbarY):null,this.railBorderYWidth=_n(s.borderTopWidth)+_n(s.borderBottomWidth),an(this.scrollbarYRail,{display:"block"}),this.railYMarginHeight=_n(s.marginTop)+_n(s.marginBottom),an(this.scrollbarYRail,{display:""}),this.railYHeight=null,this.railYRatio=null,this.reach={x:e.scrollLeft<=0?"start":e.scrollLeft>=this.contentWidth-this.containerWidth?"end":null,y:e.scrollTop<=0?"start":e.scrollTop>=this.contentHeight-this.containerHeight?"end":null},this.isAlive=!0,this.settings.handlers.forEach((function(e){return Rn[e](n)})),this.lastScrollTop=Math.floor(e.scrollTop),this.lastScrollLeft=e.scrollLeft,this.event.bind(this.element,"scroll",(function(e){return n.onScroll(e)})),Tn(this)};Ln.prototype.update=function(){this.isAlive&&(this.negativeScrollAdjustment=this.isNegativeScroll?this.element.scrollWidth-this.element.clientWidth:0,an(this.scrollbarXRail,{display:"block"}),an(this.scrollbarYRail,{display:"block"}),this.railXMarginWidth=_n(on(this.scrollbarXRail).marginLeft)+_n(on(this.scrollbarXRail).marginRight),this.railYMarginHeight=_n(on(this.scrollbarYRail).marginTop)+_n(on(this.scrollbarYRail).marginBottom),an(this.scrollbarXRail,{display:"none"}),an(this.scrollbarYRail,{display:"none"}),Tn(this),kn(this,"top",0,!1,!0),kn(this,"left",0,!1,!0),an(this.scrollbarXRail,{display:""}),an(this.scrollbarYRail,{display:""}))},Ln.prototype.onScroll=function(e){this.isAlive&&(Tn(this),kn(this,"top",this.element.scrollTop-this.lastScrollTop),kn(this,"left",this.element.scrollLeft-this.lastScrollLeft),this.lastScrollTop=Math.floor(this.element.scrollTop),this.lastScrollLeft=this.element.scrollLeft)},Ln.prototype.destroy=function(){this.isAlive&&(this.event.unbindAll(),un(this.scrollbarX),un(this.scrollbarY),un(this.scrollbarXRail),un(this.scrollbarYRail),this.removePsClasses(),this.element=null,this.scrollbarX=null,this.scrollbarY=null,this.scrollbarXRail=null,this.scrollbarYRail=null,this.isAlive=!1)},Ln.prototype.removePsClasses=function(){this.element.className=this.element.className.split(" ").filter((function(e){return!e.match(/^ps([-_].+|)$/)})).join(" ")};var Mn=function(e){var t;if("SELECT"===e.nodeName)e.focus(),t=e.value;else if("INPUT"===e.nodeName||"TEXTAREA"===e.nodeName){var n=e.hasAttribute("readonly");n||e.setAttribute("readonly",""),e.select(),e.setSelectionRange(0,e.value.length),n||e.removeAttribute("readonly"),t=e.value}else{e.hasAttribute("contenteditable")&&e.focus();var r=window.getSelection(),o=document.createRange();o.selectNodeContents(e),r.removeAllRanges(),r.addRange(o),t=r.toString()}return t},In=o((function(e,t){!function(e,t){var n,r=(n=t)&&n.__esModule?n:{default:n},o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.resolveOptions(t),this.initSelection()}return i(e,[{key:"resolveOptions",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.action=e.action,this.container=e.container,this.emitter=e.emitter,this.target=e.target,this.text=e.text,this.trigger=e.trigger,this.selectedText=""}},{key:"initSelection",value:function(){this.text?this.selectFake():this.target&&this.selectTarget()}},{key:"selectFake",value:function(){var e=this,t="rtl"==document.documentElement.getAttribute("dir");this.removeFake(),this.fakeHandlerCallback=function(){return e.removeFake()},this.fakeHandler=this.container.addEventListener("click",this.fakeHandlerCallback)||!0,this.fakeElem=document.createElement("textarea"),this.fakeElem.style.fontSize="12pt",this.fakeElem.style.border="0",this.fakeElem.style.padding="0",this.fakeElem.style.margin="0",this.fakeElem.style.position="absolute",this.fakeElem.style[t?"right":"left"]="-9999px";var n=window.pageYOffset||document.documentElement.scrollTop;this.fakeElem.style.top=n+"px",this.fakeElem.setAttribute("readonly",""),this.fakeElem.value=this.text,this.container.appendChild(this.fakeElem),this.selectedText=(0,r.default)(this.fakeElem),this.copyText()}},{key:"removeFake",value:function(){this.fakeHandler&&(this.container.removeEventListener("click",this.fakeHandlerCallback),this.fakeHandler=null,this.fakeHandlerCallback=null),this.fakeElem&&(this.container.removeChild(this.fakeElem),this.fakeElem=null)}},{key:"selectTarget",value:function(){this.selectedText=(0,r.default)(this.target),this.copyText()}},{key:"copyText",value:function(){var e=void 0;try{e=document.execCommand(this.action)}catch(t){e=!1}this.handleResult(e)}},{key:"handleResult",value:function(e){this.emitter.emit(e?"success":"error",{action:this.action,text:this.selectedText,trigger:this.trigger,clearSelection:this.clearSelection.bind(this)})}},{key:"clearSelection",value:function(){this.trigger&&this.trigger.focus(),window.getSelection().removeAllRanges()}},{key:"destroy",value:function(){this.removeFake()}},{key:"action",set:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"copy";if(this._action=e,"copy"!==this._action&&"cut"!==this._action)throw new Error('Invalid "action" value, use either "copy" or "cut"')},get:function(){return this._action}},{key:"target",set:function(e){if(void 0!==e){if(!e||"object"!==(void 0===e?"undefined":o(e))||1!==e.nodeType)throw new Error('Invalid "target" value, use a valid Element');if("copy"===this.action&&e.hasAttribute("disabled"))throw new Error('Invalid "target" attribute. Please use "readonly" instead of "disabled" attribute');if("cut"===this.action&&(e.hasAttribute("readonly")||e.hasAttribute("disabled")))throw new Error('Invalid "target" attribute. You can\'t cut text from elements with "readonly" or "disabled" attributes');this._target=e}},get:function(){return this._target}}]),e}();e.exports=a}(e,Mn)}));function An(){}r(In),An.prototype={on:function(e,t,n){var r=this.e||(this.e={});return(r[e]||(r[e]=[])).push({fn:t,ctx:n}),this},once:function(e,t,n){var r=this;function o(){r.off(e,o),t.apply(n,arguments)}return o._=t,this.on(e,o,n)},emit:function(e){for(var t=[].slice.call(arguments,1),n=((this.e||(this.e={}))[e]||[]).slice(),r=0,o=n.length;r<o;r++)n[r].fn.apply(n[r].ctx,t);return this},off:function(e,t){var n=this.e||(this.e={}),r=n[e],o=[];if(r&&t)for(var i=0,a=r.length;i<a;i++)r[i].fn!==t&&r[i].fn._!==t&&o.push(r[i]);return o.length?n[e]=o:delete n[e],this}};var On=An,zn=o((function(e,t){t.node=function(e){return void 0!==e&&e instanceof HTMLElement&&1===e.nodeType},t.nodeList=function(e){var n=Object.prototype.toString.call(e);return void 0!==e&&("[object NodeList]"===n||"[object HTMLCollection]"===n)&&"length"in e&&(0===e.length||t.node(e[0]))},t.string=function(e){return"string"==typeof e||e instanceof String},t.fn=function(e){return"[object Function]"===Object.prototype.toString.call(e)}}));zn.node,zn.nodeList,zn.string,zn.fn;if("undefined"!=typeof Element&&!Element.prototype.matches){var Nn=Element.prototype;Nn.matches=Nn.matchesSelector||Nn.mozMatchesSelector||Nn.msMatchesSelector||Nn.oMatchesSelector||Nn.webkitMatchesSelector}var Dn=function(e,t){for(;e&&9!==e.nodeType;){if("function"==typeof e.matches&&e.matches(t))return e;e=e.parentNode}};function jn(e,t,n,r){return function(n){n.delegateTarget=Dn(n.target,t),n.delegateTarget&&r.call(e,n)}}var Hn=function(e,t,n,r,o){var i=jn.apply(this,arguments);return e.addEventListener(n,i,o),{destroy:function(){e.removeEventListener(n,i,o)}}};var Xn=function(e,t,n){if(!e&&!t&&!n)throw new Error("Missing required arguments");if(!zn.string(t))throw new TypeError("Second argument must be a String");if(!zn.fn(n))throw new TypeError("Third argument must be a Function");if(zn.node(e))return function(e,t,n){return e.addEventListener(t,n),{destroy:function(){e.removeEventListener(t,n)}}}(e,t,n);if(zn.nodeList(e))return function(e,t,n){return Array.prototype.forEach.call(e,(function(e){e.addEventListener(t,n)})),{destroy:function(){Array.prototype.forEach.call(e,(function(e){e.removeEventListener(t,n)}))}}}(e,t,n);if(zn.string(e))return function(e,t,n){return Hn(document.body,e,t,n)}(e,t,n);throw new TypeError("First argument must be a String, HTMLElement, HTMLCollection, or NodeList")},Un=r(o((function(e,t){!function(e,t,n,r){var o=s(t),i=s(n),a=s(r);function s(e){return e&&e.__esModule?e:{default:e}}var c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},l=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=function(e){function t(e,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var r=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return r.resolveOptions(n),r.listenClick(e),r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),l(t,[{key:"resolveOptions",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.action="function"==typeof e.action?e.action:this.defaultAction,this.target="function"==typeof e.target?e.target:this.defaultTarget,this.text="function"==typeof e.text?e.text:this.defaultText,this.container="object"===c(e.container)?e.container:document.body}},{key:"listenClick",value:function(e){var t=this;this.listener=(0,a.default)(e,"click",(function(e){return t.onClick(e)}))}},{key:"onClick",value:function(e){var t=e.delegateTarget||e.currentTarget;this.clipboardAction&&(this.clipboardAction=null),this.clipboardAction=new o.default({action:this.action(t),target:this.target(t),text:this.text(t),container:this.container,trigger:t,emitter:this})}},{key:"defaultAction",value:function(e){return d("action",e)}},{key:"defaultTarget",value:function(e){var t=d("target",e);if(t)return document.querySelector(t)}},{key:"defaultText",value:function(e){return d("text",e)}},{key:"destroy",value:function(){this.listener.destroy(),this.clipboardAction&&(this.clipboardAction.destroy(),this.clipboardAction=null)}}],[{key:"isSupported",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:["copy","cut"],t="string"==typeof e?[e]:e,n=!!document.queryCommandSupported;return t.forEach((function(e){n=n&&!!document.queryCommandSupported(e)})),n}}]),t}(i.default);function d(e,t){var n="data-clipboard-"+e;if(t.hasAttribute(n))return t.getAttribute(n)}e.exports=u}(e,In,On,Xn)})));function Wn(e){for(var t=e&&e.parentNode;t;){if("[object ShadowRoot]"===t.toString())return!0;t=t.parentNode}return!1}function Yn(e,n){var r=n.elements;r.textElement.addEventListener("click",(function(r){return function(e,n,r){var o=r,i=r.elements;if(e.target.id!=="prompter-text".concat(r.randomString)){var a=e.target.id.replace("word-","").replace(r.randomString,""),s=JSON.parse(n.exports[t.Exports.JIIX]).words;if(o.wordToChange=s[a],o.wordToChange.id=a,i.candidatesElement.innerHTML="",o.wordToChange&&o.wordToChange.candidates){i.candidatesElement.style.display="flex",o.wordToChange.candidates.forEach((function(e,t){o.wordToChange.label===e?i.candidatesElement.innerHTML+='<span id="cdt-'.concat(t).concat(r.randomString,'" class="selected-word">').concat(e,"</span>"):i.candidatesElement.innerHTML+='<span id="cdt-'.concat(t).concat(r.randomString,'">').concat(e,"</span>")}));var c=e.target.getBoundingClientRect().left-60;i.candidatesElement.style.top="".concat(48,"px"),i.candidatesElement.style.left="".concat(c,"px"),e.target.parentNode.parentNode.parentNode.insertBefore(i.candidatesElement,e.target.parentNode.parentNode)}}}(r,e,n)})),r.candidatesElement.addEventListener("click",(function(r){return function(e,n,r){var o=r,i=r.elements,a=e.target.innerText;if(a!==o.wordToChange.label&&o.wordToChange.candidates.includes(a)){var s=JSON.parse(n.exports[t.Exports.JIIX]);s.words[o.wordToChange.id].label=a,n.import_(JSON.stringify(s),t.Exports.JIIX)}i.candidatesElement.style.display="none"}(r,e,n)})),r.ellipsisElement.addEventListener("click",(function(e){return function(e,t){var n=t,r=function(){var t=e.target.offsetLeft-68;n.menuElement.style.left="".concat(t,"px")},o=document.contains(n.menuElement);Wn(n.menuElement)||o?"none"===n.menuElement.style.display&&(r(),n.menuElement.style.display="flex"):(n.menuElement.style.display="flex",r(),n.menuElement.appendChild(n.convertElement),n.menuElement.appendChild(n.copyElement),n.menuElement.appendChild(n.deleteElement),e.target.parentNode.insertBefore(n.menuElement,e.target))}(e,r)})),r.copyElement.addEventListener("click",(function(){r.menuElement.style.display="none"})),r.convertElement.addEventListener("click",(function(){r.menuElement.style.display="none",e.convert()})),r.deleteElement.addEventListener("click",(function(){r.menuElement.style.display="none",e.clear()}))}function Bn(e){var t="-"+Math.random().toString(10).substring(2,12),n=function(e){var t=document.createElement("div");t.id="smartguide"+e,t.classList.add("smartguide");var n=document.createElement("div");n.id="prompter-text"+e,n.classList.add("prompter-text"),n.setAttribute("touch-action","none");var r=document.createElement("div");r.id="prompter-text-container"+e,r.classList.add("prompter-text-container"),r.appendChild(n);var o=document.createElement("div");o.id="ellipsis"+e,o.classList.add("ellipsis"),o.innerHTML="...";var i=document.createElement("div");i.id="tag-icon"+e,i.classList.add("tag-icon"),i.innerHTML="&#182;";var a=document.createElement("div");a.id="candidates"+e,a.classList.add("candidates");var s=document.createElement("div");s.id="more-menu"+e,s.classList.add("more-menu");var c=document.createElement("button");c.classList.add("options-label-button"),c.id="convert"+e,c.innerHTML="Convert";var l=document.createElement("button");l.classList.add("options-label-button"),l.id="copy"+e,l.innerHTML="Copy";var u=document.createElement("button");return u.classList.add("options-label-button"),u.id="delete"+e,u.innerHTML="Delete",{smartGuideElement:t,textElement:n,textContainer:r,candidatesElement:a,menuElement:s,tagElement:i,ellipsisElement:o,convertElement:c,copyElement:l,deleteElement:u}}(t),r=(new Un(n.copyElement),{editor:e,wordToChange:"",lastWord:"",previousLabelExport:" ",perfectScrollbar:new Ln(n.textContainer,{suppressScrollY:!0,scrollXMarginOffset:1}),elements:n,smartGuideTimeOutId:0,randomString:t});return Yn(e,r),e.configuration.recognitionParams.iink.text.smartGuideFadeOut.enable&&function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1e4,t=arguments.length>1?arguments[1]:void 0,n=t,r=t.elements,o=new MutationObserver((function(t){t.forEach((function(){n.smartGuideTimeOutId&&clearTimeout(n.smartGuideTimeOutId),"none"===r.candidatesElement.style.display&&"none"===r.menuElement.style.display?n.smartGuideTimeOutId=setTimeout((function(){r.smartGuideElement.classList.add("smartguide-out"),r.smartGuideElement.classList.remove("smartguide-in")}),e):document.contains(r.candidatesElement)||document.contains(r.menuElement)||(n.smartGuideTimeOutId=setTimeout((function(){r.smartGuideElement.classList.add("smartguide-out"),r.smartGuideElement.classList.remove("smartguide-in")}),e))}))}));o.observe(r.smartGuideElement,{childList:!0,subtree:!0,attributes:!0})}(e.configuration.recognitionParams.iink.text.smartGuideFadeOut.duration,r),r}function Gn(e){var t=e,n=e.elements,r=3.779527559*t.editor.configuration.recognitionParams.iink.text.margin.left,o=t.editor.domElement.clientWidth-r-n.tagElement.offsetWidth-35-r;n.textContainer.style.width="".concat(o,"px"),n.textContainer.style.maxWidth="".concat(o,"px"),r=n.tagElement.offsetWidth,r+=o,n.ellipsisElement.style.left="".concat(r,"px"),n.smartGuideElement.style.width="".concat(n.tagElement.offsetWidth+n.textContainer.offsetWidth+n.ellipsisElement.offsetWidth,"px"),t.perfectScrollbar.update()}function Fn(e,n){var r=e,o=e.elements,i=document.contains(o.smartGuideElement);Wn(o.smartGuideElement)||i||function(e){var t=e,n=e.elements,r=3.779527559*t.editor.configuration.recognitionParams.iink.text.margin.top,o=3.779527559*t.editor.configuration.recognitionParams.iink.text.margin.left;!function(e,r){n.smartGuideElement.style.top="".concat(r,"px"),n.smartGuideElement.style.left="".concat(e,"px"),n.smartGuideElement.style.visibility="hidden",t.editor.domElement.insertBefore(n.smartGuideElement,t.editor.loader)}(o,r-45.354330708),n.smartGuideElement.appendChild(n.tagElement);var i=t.editor.domElement.clientWidth-o-n.tagElement.offsetWidth-35-o;(function(e,t){n.textContainer.style.left="".concat(e,"px"),n.textContainer.style.width="".concat(t,"px"),n.textContainer.style.maxWidth="".concat(t,"px"),n.smartGuideElement.appendChild(n.textContainer)})(o=n.tagElement.offsetWidth,i),function(e){n.ellipsisElement.style.left="".concat(e,"px"),n.smartGuideElement.appendChild(n.ellipsisElement)}(o+=i),n.menuElement.style.display="none",n.menuElement.appendChild(n.convertElement),n.menuElement.appendChild(n.copyElement),n.menuElement.appendChild(n.deleteElement),n.smartGuideElement.appendChild(n.menuElement),n.candidatesElement.style.display="none",n.smartGuideElement.appendChild(n.candidatesElement),n.smartGuideElement.style.height="48px",n.smartGuideElement.style.width="".concat(n.tagElement.offsetWidth+n.textContainer.offsetWidth+n.ellipsisElement.offsetWidth,"px"),t.perfectScrollbar.update()}(e);var a=function(t,n,r){var o=document.createElement("span");return o.id="word-".concat(n).concat(e.randomString),t?o.innerHTML="&nbsp;":o.textContent=r.label,o};if(n&&JSON.parse(n[t.Exports.JIIX]).words.length>0){if(o.smartGuideElement.classList.add("smartguide-in"),o.smartGuideElement.classList.remove("smartguide-out"),o.candidatesElement.style.display="none",o.menuElement.style.display="none",r.previousLabelExport&&r.previousLabelExport!==JSON.parse(n[t.Exports.JIIX]).label){var s=JSON.parse(n[t.Exports.JIIX]).words;!function(e){o.textElement.innerHTML="";var t=document.createDocumentFragment();e.forEach((function(n,i){if(" "===n.label||n.label.includes("\n"))t.appendChild(a(!0,i));else if(i!==e.length-1)t.appendChild(a(!1,i,n));else{o.textElement.appendChild(t),r.perfectScrollbar.update(),""===r.lastWord&&(r.lastWord=n);var s=a(!1,i,n);r.lastWord.candidates!==n.candidates&&r.lastWord.label!==n.label?(s.classList.add("added-word"),o.textElement.appendChild(s),o.textContainer.scrollLeft=s.offsetLeft,r.lastWord=n):(o.textElement.appendChild(s),o.textContainer.scrollLeft=s.offsetLeft)}}))}(s),function(i){if(r.tempWords&&r.tempWords.length===i.length){var a=i.map((function(e){return e.label})),s=r.tempWords.map((function(e){return e.label})),c=a.indexOf(a.filter((function(e){return-1===s.indexOf(e)}))[0]);document.getElementById("word-".concat(c).concat(e.randomString))&&c>-1&&(document.getElementById("word-".concat(c).concat(e.randomString)).classList.add("modified-word"),o.textContainer.scrollLeft=document.getElementById("word-".concat(c).concat(e.randomString)).offsetLeft-10)}r.tempWords=JSON.parse(n[t.Exports.JIIX]).words}(s)}r.previousLabelExport=JSON.parse(n[t.Exports.JIIX]).label,o.copyElement.setAttribute("data-clipboard-text",JSON.parse(n[t.Exports.JIIX]).label)}else o.smartGuideElement.classList.add("smartguide-out"),o.smartGuideElement.classList.remove("smartguide-in");return r}var Jn=o((function(e){var t=function(e){var t=Object.prototype,n=t.hasOwnProperty,r="function"==typeof Symbol?Symbol:{},o=r.iterator||"@@iterator",i=r.asyncIterator||"@@asyncIterator",a=r.toStringTag||"@@toStringTag";function s(e,t,n,r){var o=t&&t.prototype instanceof u?t:u,i=Object.create(o.prototype),a=new E(r||[]);return i._invoke=function(e,t,n){var r="suspendedStart";return function(o,i){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===o)throw i;return _()}for(n.method=o,n.arg=i;;){var a=n.delegate;if(a){var s=b(a,n);if(s){if(s===l)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var u=c(e,t,n);if("normal"===u.type){if(r=n.done?"completed":"suspendedYield",u.arg===l)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(r="completed",n.method="throw",n.arg=u.arg)}}}(e,n,a),i}function c(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}e.wrap=s;var l={};function u(){}function d(){}function p(){}var h={};h[o]=function(){return this};var f=Object.getPrototypeOf,g=f&&f(f(k([])));g&&g!==t&&n.call(g,o)&&(h=g);var m=p.prototype=u.prototype=Object.create(h);function v(e){["next","throw","return"].forEach((function(t){e[t]=function(e){return this._invoke(t,e)}}))}function y(e,t){var r;this._invoke=function(o,i){function a(){return new t((function(r,a){!function r(o,i,a,s){var l=c(e[o],e,i);if("throw"!==l.type){var u=l.arg,d=u.value;return d&&"object"==typeof d&&n.call(d,"__await")?t.resolve(d.__await).then((function(e){r("next",e,a,s)}),(function(e){r("throw",e,a,s)})):t.resolve(d).then((function(e){u.value=e,a(u)}),(function(e){return r("throw",e,a,s)}))}s(l.arg)}(o,i,r,a)}))}return r=r?r.then(a,a):a()}}function b(e,t){var n=e.iterator[t.method];if(void 0===n){if(t.delegate=null,"throw"===t.method){if(e.iterator.return&&(t.method="return",t.arg=void 0,b(e,t),"throw"===t.method))return l;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return l}var r=c(n,e.iterator,t.arg);if("throw"===r.type)return t.method="throw",t.arg=r.arg,t.delegate=null,l;var o=r.arg;return o?o.done?(t[e.resultName]=o.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,l):o:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,l)}function x(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function w(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function E(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(x,this),this.reset(!0)}function k(e){if(e){var t=e[o];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,i=function t(){for(;++r<e.length;)if(n.call(e,r))return t.value=e[r],t.done=!1,t;return t.value=void 0,t.done=!0,t};return i.next=i}}return{next:_}}function _(){return{value:void 0,done:!0}}return d.prototype=m.constructor=p,p.constructor=d,p[a]=d.displayName="GeneratorFunction",e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===d||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,p):(e.__proto__=p,a in e||(e[a]="GeneratorFunction")),e.prototype=Object.create(m),e},e.awrap=function(e){return{__await:e}},v(y.prototype),y.prototype[i]=function(){return this},e.AsyncIterator=y,e.async=function(t,n,r,o,i){void 0===i&&(i=Promise);var a=new y(s(t,n,r,o),i);return e.isGeneratorFunction(n)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},v(m),m[a]="Generator",m[o]=function(){return this},m.toString=function(){return"[object Generator]"},e.keys=function(e){var t=[];for(var n in e)t.push(n);return t.reverse(),function n(){for(;t.length;){var r=t.pop();if(r in e)return n.value=r,n.done=!1,n}return n.done=!0,n}},e.values=k,E.prototype={constructor:E,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(w),!e)for(var t in this)"t"===t.charAt(0)&&n.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function r(n,r){return a.type="throw",a.arg=e,t.next=n,r&&(t.method="next",t.arg=void 0),!!r}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i.completion;if("root"===i.tryLoc)return r("end");if(i.tryLoc<=this.prev){var s=n.call(i,"catchLoc"),c=n.call(i,"finallyLoc");if(s&&c){if(this.prev<i.catchLoc)return r(i.catchLoc,!0);if(this.prev<i.finallyLoc)return r(i.finallyLoc)}else if(s){if(this.prev<i.catchLoc)return r(i.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return r(i.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=e,a.arg=t,i?(this.method="next",this.next=i.finallyLoc,l):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),l},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),w(n),l}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var o=r.arg;w(n)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:k(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=void 0),l}},e}(e.exports);try{regeneratorRuntime=t}catch(e){Function("r","regeneratorRuntime = r")(t)}}));function Kn(e){var t=e;return t.canUndo=e.currentPosition>0,t.canRedo=e.currentPosition<e.stack.length-1,t}function Vn(e){for(var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=e.stack[e.currentPosition],r=arguments.length,o=new Array(r>2?r-2:0),i=2;i<r;i++)o[i-2]=arguments[i];var a={res:t?me(n):n,types:o};return Promise.resolve(a)}var qn=Object.freeze({__proto__:null,getModel:Vn,updateModel:function(e,n){var r=e.stack.findIndex((function(e){return e.modificationTime===n.modificationTime&&e.rawStrokes.length===n.rawStrokes.length})),o=n;o.modificationTime=(new Date).getTime();var i=[];if(r>-1)e.stack.splice(r,1,me(o)),s.debug("model updated",o);else{var a=e;a.currentPosition+=1,a.stack=a.stack.slice(0,a.currentPosition),a.stack.push(me(o)),a.stack.length>a.maxSize&&(a.stack.shift(),a.currentPosition--),s.debug("model pushed",o),i.push(t.EventType.CHANGED)}return Kn(e),s.debug("undo/redo stack updated",e),Vn.apply(void 0,[e,!1].concat(i))},undo:function(e,n){var r=e;return r.currentPosition>0&&(r.currentPosition-=1,Kn(e),s.debug("undo index",r.currentPosition)),Vn(e,!0,t.EventType.CHANGED,t.EventType.EXPORTED)},redo:function(e,n){var r=e;return r.currentPosition<r.stack.length-1&&(r.currentPosition+=1,Kn(e),s.debug("redo index",r.currentPosition)),Vn(e,!0,t.EventType.CHANGED,t.EventType.EXPORTED)}});function Zn(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10,n=document,r=n.createElement("canvas");return r.width=Math.abs(e.maxX-e.minX)+2*t,r.style.width="".concat(r.width,"px"),r.height=Math.abs(e.maxY-e.minY)+2*t,r.style.height="".concat(r.height,"px"),r}var $n=Object.freeze({__proto__:null,inkImporter:function(e,t,n,r){var o=e;a.debug("inkImporter start importing =>",t);var i=Object.assign({},o.behavior.grabber);i.detach=o.behavior.grabber.detach,o.behavior.grabber={};var s=[];t.forEach((function(e){e.convert?s.push({action:"convert",value:!0}):e.setDelay?s.push({action:"setDelay",value:e.setDelay}):(e.color&&s.push({action:"setColor",value:e.color}),e.X.forEach((function(t,n){var r="move";0===n?r="down":n===e.X.length-1&&(r="up"),s.push({action:r,point:{x:e.X[n],y:e.Y[n]}})})))})),a.debug("Array of actions =>",s),function e(t,n,a){if(n<t.length){var s=t[n],c=a;if("convert"===s.action?o.convert():"setDelay"===s.action?c=s.value:"setColor"===s.action?o.penStyle={color:s.value}:(s.point.t=(new Date).getTime(),"down"===s.action?o.pointerDown(s.point):"up"===s.action?o.pointerUp(s.point):"move"===s.action&&o.pointerMove(s.point)),r&&n===t.map((function(e){return e.action})).lastIndexOf("down")-1)setTimeout((function(){e(t,n+1,c)}),r);else if(n===t.length-1){var l=new Event("drawEnded");document.dispatchEvent(l),o.behavior.grabber=i}else setTimeout((function(){e(t,n+1,c)}),c)}}(s,0,n)},importStrokeGroups:function(e,t){t.forEach((function(t){t.strokes.forEach((function(n){oe(e.model,n),ie(e.model,n,t.penStyle)}))})),e.renderer.drawModel(e.rendererContext,e.model,e.stroker)}});function Qn(){var e,t;return{promise:new Promise((function(n,r){e=n,t=r})),resolve:e,reject:t}}function er(e){var t=null;return{promise:new Promise((function(n){t=setTimeout(n,e)})),timer:t}}function tr(e,t){return e.recognizer.reset&&Zt(e.recognizerContext,t)?e.recognizer.reset(e.recognizerContext,t):null}function nr(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e.configuration.triggers[t];return!(!e.recognizer||!e.recognizer.getInfo().availableTriggers[t].includes(n))||(a.error("".concat(n," is not a valid trigger for ").concat(t)),!1)}function rr(){return(rr=C(Jn.mark((function e(t,n){var r,o,i=arguments;return Jn.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=i.length>2&&void 0!==i[2]?i[2]:t.configuration.triggers.addStrokes,!t.recognizer||!t.recognizer.addStrokes){e.next=13;break}return e.next=4,t.recognizerContext.initPromise;case 4:if(!e.sent){e.next=13;break}if(!nr(t,"addStrokes",r)){e.next=13;break}return e.next=9,tr(t,n);case 9:if(!(o=e.sent)){e.next=12;break}return e.abrupt("return",t.recognizer.addStrokes(t.recognizerContext,o));case 12:return e.abrupt("return",t.recognizer.addStrokes(t.recognizerContext,n));case 13:return e.abrupt("return",Promise.reject(new Error("Cannot addStrokes")));case 14:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function or(){return(or=C(Jn.mark((function e(t,n,r){return Jn.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.recognizer||!t.recognizer.pointerEvents){e.next=6;break}return e.next=3,t.recognizerContext.initPromise;case 3:if(!e.sent){e.next=6;break}return e.abrupt("return",t.recognizer.pointerEvents(t.recognizerContext,n,r));case 6:return e.abrupt("return",Promise.reject(new Error("Cannot launch pointerEvents")));case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ir(e,t,n){return ar.apply(this,arguments)}function ar(){return(ar=C(Jn.mark((function e(n,r,o){var i,a,s,c,l,u=arguments;return Jn.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=u.length>3&&void 0!==u[3]?u[3]:n.configuration.triggers.exportContent,!n.recognizer||!n.recognizer.export_){e.next=20;break}return e.next=4,n.recognizerContext.initPromise;case 4:if(!e.sent){e.next=20;break}if(!nr(n,"exportContent",i)){e.next=20;break}return a=n,window.clearTimeout(n.exportTimer),s=i===t.Trigger.QUIET_PERIOD?n.configuration.triggerDelay:0,c=er(s),a.exportTimer=c.timer,e.next=14,c.promise;case 14:return e.next=16,tr(n,r);case 16:if(!(l=e.sent)){e.next=19;break}return e.abrupt("return",n.recognizer.export_(n.recognizerContext,l,o));case 19:return e.abrupt("return",n.recognizer.export_(n.recognizerContext,r,o));case 20:return e.abrupt("return",Promise.reject(new Error("Cannot launch export")));case 21:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function sr(){return(sr=C(Jn.mark((function e(t,n,r){return Jn.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.recognizer||!t.recognizer.import_){e.next=6;break}return e.next=3,t.recognizerContext.initPromise;case 3:if(!e.sent){e.next=6;break}return e.abrupt("return",t.recognizer.import_(t.recognizerContext,n,r));case 6:return e.abrupt("return",Promise.reject(new Error("Cannot launch import")));case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function cr(){return(cr=C(Jn.mark((function e(t,n){return Jn.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.recognizer||!t.recognizer.getSupportedImportMimeTypes){e.next=6;break}return e.next=3,t.recognizerContext.initPromise;case 3:if(!e.sent){e.next=6;break}return e.abrupt("return",t.recognizer.getSupportedImportMimeTypes(t.recognizerContext,n));case 6:return e.abrupt("return",Promise.reject(new Error("Cannot launch getSupportedImportMimeTypes")));case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function lr(e,t,n){return ur.apply(this,arguments)}function ur(){return(ur=C(Jn.mark((function e(t,n,r){return Jn.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.recognizer||!t.recognizer.convert){e.next=6;break}return e.next=3,t.recognizerContext.initPromise;case 3:if(!e.sent){e.next=6;break}return e.abrupt("return",t.recognizer.convert(t.recognizerContext,n,r));case 6:return e.abrupt("return",Promise.reject(new Error("Cannot launch convert")));case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function dr(e,t){return pr.apply(this,arguments)}function pr(){return(pr=C(Jn.mark((function e(t,n){return Jn.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.recognizer||!t.recognizer.sendConfiguration){e.next=6;break}return e.next=3,t.recognizerContext.initPromise;case 3:if(!e.sent){e.next=6;break}return e.abrupt("return",t.recognizer.sendConfiguration(t.recognizerContext,n));case 6:return e.abrupt("return",Promise.reject(new Error("Cannot launch config")));case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function hr(){return(hr=C(Jn.mark((function e(t,n){var r,o;return Jn.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.recognizer||!t.recognizer.resize){e.next=13;break}return e.next=3,t.recognizerContext.initPromise;case 3:if(!e.sent){e.next=13;break}return r=t,window.clearTimeout(t.resizeTimer),o=er(t.configuration.resizeTriggerDelay),r.resizeTimer=o.timer,Gn(t.smartGuide),e.next=12,o.promise;case 12:return e.abrupt("return",t.recognizer.resize(t.recognizerContext,n,t.domElement));case 13:return e.abrupt("return",Promise.reject(new Error("Cannot launch resize")));case 14:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function fr(){return(fr=C(Jn.mark((function e(t,n){return Jn.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.recognizer||!t.recognizer.waitForIdle){e.next=6;break}return e.next=3,t.recognizerContext.initPromise;case 3:if(!e.sent){e.next=6;break}return e.abrupt("return",t.recognizer.waitForIdle(t.recognizerContext,n));case 6:return e.abrupt("return",Promise.reject(new Error("Cannot launch wait for idle")));case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function gr(){return(gr=C(Jn.mark((function e(t,n){return Jn.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.recognizer||!t.recognizer.setPenStyle){e.next=6;break}return e.next=3,t.recognizerContext.initPromise;case 3:if(!e.sent){e.next=6;break}return e.abrupt("return",t.recognizer.setPenStyle(t.recognizerContext,n,t.penStyle));case 6:return e.abrupt("return",Promise.reject(new Error("Cannot set pentStyle")));case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function mr(){return(mr=C(Jn.mark((function e(t,n){return Jn.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.recognizer||!t.recognizer.setPenStyleClasses){e.next=6;break}return e.next=3,t.recognizerContext.initPromise;case 3:if(!e.sent){e.next=6;break}return e.abrupt("return",t.recognizer.setPenStyleClasses(t.recognizerContext,n,t.penStyleClasses));case 6:return e.abrupt("return",Promise.reject(new Error("Cannot set penStyleClasses")));case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function vr(){return(vr=C(Jn.mark((function e(t,n){return Jn.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.recognizer||!t.recognizer.setTheme){e.next=6;break}return e.next=3,t.recognizerContext.initPromise;case 3:if(!e.sent){e.next=6;break}return e.abrupt("return",t.recognizer.setTheme(t.recognizerContext,n,t.theme));case 6:return e.abrupt("return",Promise.reject(new Error("Cannot set theme")));case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var yr=function(){function e(t,n,r,o,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e);var s=document.createElement("style");s.appendChild(document.createTextNode("")),t.appendChild(s);var c=s.sheet;s.textContent="/*\n * Container style\n */\n.ps {\n  overflow: hidden !important;\n  overflow-anchor: none;\n  -ms-overflow-style: none;\n  touch-action: auto;\n  -ms-touch-action: auto;\n}\n/*\n * Scrollbar rail styles\n */\n.ps__rail-x {\n  display: none;\n  opacity: 0;\n  transition: background-color .2s linear, opacity .2s linear;\n  -webkit-transition: background-color .2s linear, opacity .2s linear;\n  height: 15px;\n  /* there must be 'bottom' or 'top' for ps__rail-x */\n  bottom: 0px;\n  /* please don't change 'position' */\n  position: absolute;\n}\n.ps__rail-y {\n  display: none;\n  opacity: 0;\n  transition: background-color .2s linear, opacity .2s linear;\n  -webkit-transition: background-color .2s linear, opacity .2s linear;\n  width: 15px;\n  /* there must be 'right' or 'left' for ps__rail-y */\n  right: 0;\n  /* please don't change 'position' */\n  position: absolute;\n}\n.ps--active-x > .ps__rail-x,\n.ps--active-y > .ps__rail-y {\n  display: block;\n  background-color: transparent;\n}\n.ps:hover > .ps__rail-x,\n.ps:hover > .ps__rail-y,\n.ps--focus > .ps__rail-x,\n.ps--focus > .ps__rail-y,\n.ps--scrolling-x > .ps__rail-x,\n.ps--scrolling-y > .ps__rail-y {\n  opacity: 0.6;\n}\n.ps .ps__rail-x:hover,\n.ps .ps__rail-y:hover,\n.ps .ps__rail-x:focus,\n.ps .ps__rail-y:focus,\n.ps .ps__rail-x.ps--clicking,\n.ps .ps__rail-y.ps--clicking {\n  background-color: #eee;\n  opacity: 0.9;\n}\n/*\n * Scrollbar thumb styles\n */\n.ps__thumb-x {\n  background-color: #aaa;\n  border-radius: 6px;\n  transition: background-color .2s linear, height .2s ease-in-out;\n  -webkit-transition: background-color .2s linear, height .2s ease-in-out;\n  height: 6px;\n  /* there must be 'bottom' for ps__thumb-x */\n  bottom: 2px;\n  /* please don't change 'position' */\n  position: absolute;\n}\n.ps__thumb-y {\n  background-color: #aaa;\n  border-radius: 6px;\n  transition: background-color .2s linear, width .2s ease-in-out;\n  -webkit-transition: background-color .2s linear, width .2s ease-in-out;\n  width: 6px;\n  /* there must be 'right' for ps__thumb-y */\n  right: 2px;\n  /* please don't change 'position' */\n  position: absolute;\n}\n.ps__rail-x:hover > .ps__thumb-x,\n.ps__rail-x:focus > .ps__thumb-x,\n.ps__rail-x.ps--clicking .ps__thumb-x {\n  background-color: #999;\n  height: 11px;\n}\n.ps__rail-y:hover > .ps__thumb-y,\n.ps__rail-y:focus > .ps__thumb-y,\n.ps__rail-y.ps--clicking .ps__thumb-y {\n  background-color: #999;\n  width: 11px;\n}\n/* MS supports */\n@supports (-ms-overflow-style: none) {\n  .ps {\n    overflow: auto !important;\n  }\n}\n@media screen and (-ms-high-contrast: active), (-ms-high-contrast: none) {\n  .ps {\n    overflow: auto !important;\n  }\n}\n.ms-editor {\n    position: relative;\n    z-index: 20;\n    color: #1A9FFF;\n    font-family: sans-serif;\n}\n.ms-editor canvas,\n.ms-editor svg {\n    z-index: 15;\n    position: absolute;\n    left: 0;\n    top: 0;\n    height: 100%;\n    width: 100%;\n}\n.ms-editor canvas.ms-rendering-canvas {\n    z-index: 10;\n    pointer-events: none;\n    background-image: linear-gradient(to right, #F5F6F7 1px, transparent 1px),\n    linear-gradient(to bottom, #F5F6F7 1px, transparent 1px);\n    background-size: 18px 18px;\n}\n.ms-editor svg {\n    z-index: 10;\n    pointer-events: none;\n}\n.ms-editor svg[data-layer=\"BACKGROUND\"] {\n    z-index: 9;\n}\n.ms-editor .loader {\n    z-index: 30;\n    position: absolute;\n    width: 120px;\n    height: 120px;\n    top: calc(50% - 60px);\n    left: calc(50% - 60px);\n    border: 16px solid #F5F6F7;\n    border-radius: 50%;\n    border-top-color: #1A9FFF;\n    -webkit-animation: spin 2s linear infinite;\n    animation: spin 2s linear infinite;\n}\n.ms-editor .error-msg {\n    z-index: 25;\n    position: absolute;\n    width: 200px;\n    height: 200px;\n    top: calc(50% - 100px);\n    left: calc(50% - 100px);\n    font-size: 16px;\n    text-align: center;\n    word-wrap: break-word;\n}\n.ms-editor .error-msg::before {\n    content: url(data:image/svg+xml;base64,PHN2ZyB2ZXJzaW9uPSIxLjEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgdmlld0JveD0iMCA3Ni41IDYxMiA0NTkiIHByZXNlcnZlQXNwZWN0UmF0aW89InhNaW5ZTWluIG1lZXQiPgogICAgPHBhdGggZmlsbD0iIzFBOUZGRiIgZD0iTTQ5NC43LDIyOS41Yy0xNy44NTEtODYuNy05NC4zNTEtMTUzLTE4OC43LTE1M2MtMzguMjUsMC03My45NSwxMC4yLTEwMiwzMC42bDM4LjI1LDM4LjI1IGMxNy44NS0xMi43NSw0MC44LTE3Ljg1LDYzLjc1LTE3Ljg1Yzc2LjUsMCwxNDAuMjUsNjMuNzUsMTQwLjI1LDE0MC4yNXYxMi43NWgzOC4yNWM0My4zNSwwLDc2LjUsMzMuMTUsNzYuNSw3Ni41IGMwLDI4LjA1LTE1LjMsNTMuNTUtNDAuOCw2Ni4zbDM4LjI1LDM4LjI1QzU5MS42LDQzOC42LDYxMiw0MDAuMzUsNjEyLDM1N0M2MTIsMjkwLjcsNTU4LjQ1LDIzNC42LDQ5NC43LDIyOS41eiBNNzYuNSwxMDkuNjUgbDcxLjQsNjguODVDNjYuMywxODMuNiwwLDI0OS45LDAsMzMxLjVjMCw4NC4xNSw2OC44NSwxNTMsMTUzLDE1M2gyOTguMzVsNTEsNTFsMzMuMTUtMzMuMTVMMTA5LjY1LDc2LjVMNzYuNSwxMDkuNjV6IE0xOTYuMzUsMjI5LjVsMjA0LDIwNEgxNTNjLTU2LjEsMC0xMDItNDUuOS0xMDItMTAyYzAtNTYuMSw0NS45LTEwMiwxMDItMTAySDE5Ni4zNXoiIC8+Cjwvc3ZnPgo=);\n}\n.smartguide {\n    position: absolute;\n    z-index: 40;\n    font-size: 16px;\n}\n.smartguide-in {\n    visibility: visible !important;\n    transition: opacity 0.5s;\n    opacity: 1;\n}\n.smartguide-out {\n    transition: opacity 1s, visibility 1s;\n    visibility: hidden !important;\n    opacity: 0;\n}\n.prompter-text-container {\n    background-color: rgba(255, 255, 255, 0.9);\n    height: 48px;\n    line-height: 48px;\n    overflow: hidden;\n    white-space: nowrap;\n    display: block;\n    text-align: left;\n    border-bottom: 1px solid #959DA6;\n    position: absolute;\n    z-index: 30;\n    color: #bfbfbf;\n    -moz-user-select: none;\n    -webkit-user-select: none;\n    -ms-user-select: none;\n    user-select: none;\n    -webkit-tap-highlight-color: transparent;\n}\n.prompter-text-container > div > span {\n    cursor: pointer;\n    display: inline-block;\n}\n.prompter-text {\n    margin-left: 12px;\n}\n.added-word {\n    animation: 0.1s linear word-added,\n    3s ease-in-out color-input;\n}\n.modified-word {\n    animation: 0.1s linear word-modified,\n    3s ease-in-out color-input;\n}\n@keyframes color-input {\n    0% {\n        color: black;\n    }\n    100% {\n        color: #bfbfbf;\n    }\n}\n@keyframes word-added {\n    0% {\n        transform: translate(5px, 0);\n    }\n    100% {\n        transform: none;\n    }\n}\n@keyframes word-modified {\n    0% {\n        transform: translate(0, 5px);\n    }\n    100% {\n        transform: none;\n    }\n}\n.candidates {\n    color: black;\n    flex-direction: column;\n    text-align: center;\n    line-height: 30px;\n    border-radius: 3px;\n    position: absolute;\n    box-shadow: 2px 2px 12px #BDBDBD, -2px 2px 12px #BDBDBD;\n    background-color: #F5F5F5;\n    z-index: 100;\n    -webkit-tap-highlight-color: transparent;\n}\n.candidates > span {\n    cursor: pointer;\n    padding: 2px 20px;\n}\n.candidates > span:hover {\n    background-color: #EEEEEE;\n}\n.candidates > span:active {\n    background-color: #E0E0E0;\n}\n.selected-word {\n    font-weight: bold;\n    background-color: #E0E0E0;\n}\n.tag-icon {\n    padding: 0 18px;\n    border: 1px solid #959DA6;\n    font-weight: bold;\n    font-size: large;\n    -moz-user-select: none;\n    -webkit-user-select: none;\n    -ms-user-select: none;\n    user-select: none;\n    position: absolute;\n    z-index: 31;\n    height: 48px;\n    line-height: 48px;\n    background-color: rgba(255, 255, 255, 0.9);\n    color: #959DA6;\n}\n.ellipsis {\n    cursor: pointer;\n    border-bottom: 1px solid #959DA6;\n    position: absolute;\n    z-index: 31;\n    height: 48px;\n    line-height: 38px;\n    padding: 0 8px;\n    font-weight: bold;\n    font-size: x-large;\n    background-color: rgba(255, 255, 255, 0.9);\n    color: #959DA6;\n    -moz-user-select: none;\n    -webkit-user-select: none;\n    -ms-user-select: none;\n    user-select: none;\n    -webkit-tap-highlight-color: transparent;\n}\n.ellipsis:active {\n    background-color: #e0e0e0;\n}\n.more-menu {\n    flex-direction: column;\n    margin-right: 12px;\n    line-height: 30px;\n    border-radius: 3px;\n    position: absolute;\n    z-index: 100;\n    box-shadow: 2px 2px 12px #BDBDBD;\n    background-color: #F5F5F5;\n}\n.options-label-button {\n    color: black;\n    font-size: 16px;\n    cursor: pointer;\n    box-sizing: border-box;\n    background: transparent;\n    border: none;\n    padding: 0 24px;\n    margin: 0;\n    height: 40px;\n    outline: none;\n    -webkit-tap-highlight-color: transparent;\n}\n.options-label-button:hover {\n    background-color: #EEEEEE;\n}\n.options-label-button:active {\n    background-color: #E0E0E0;\n}\n.ps__rail-x {\n    top: 32px !important;\n}\n/** Stroke **/\n.removed-stroke {\n    opacity: 0;\n    transition: opacity 0.1s ease-in-out;\n}\n.added-stroke {\n    animation: 0.2s opacity-appear;\n}\n@keyframes opacity-appear {\n    0% {\n        opacity: 0;\n    }\n    100% {\n        opacity : 1;\n    }\n}\n@keyframes spin {\n    0% {\n        transform: rotate(0deg);\n    }\n    100% {\n        transform: rotate(360deg);\n    }\n}\n@keyframes rotate-plan {\n    0% {\n        transform: perspective(120px) rotateX(0deg) rotateY(0deg);\n    }\n    25% {\n        transform: perspective(120px) rotateX(0deg) rotateY(-180deg);\n    }\n    50% {\n        transform: perspective(120px) rotateX(-180deg) rotateY(-180deg);\n    }\n    75% {\n        transform: perspective(120px) rotateX(-180deg) rotateY(0deg);\n    }\n    100% {\n        transform: perspective(120px) rotateX(0deg) rotateY(0deg);\n    }\n}\n@-webkit-keyframes rotate-plan {\n    0% {\n        -webkit-transform: perspective(120px) rotateX(0deg) rotateY(0deg)\n    }\n    25% {\n        -webkit-transform: perspective(120px) rotateX(180deg) rotateY(0deg)\n    }\n    50% {\n        -webkit-transform: perspective(120px) rotateX(180deg) rotateY(180deg)\n    }\n    75% {\n        -webkit-transform: perspective(120px) rotateX(0deg) rotateY(180deg)\n    }\n    100% {\n        -webkit-transform: perspective(120px) rotateX(0deg) rotateY(0deg)\n    }\n}\n@-webkit-keyframes spin {\n    0% {\n        -webkit-transform: rotate(0deg);\n    }\n    100% {\n        -webkit-transform: rotate(360deg);\n    }\n}\n",this.sheet=c,this.domElement=t,this.domElement.classList.add("ms-editor"),this.loader=document.createElement("div"),this.loader.classList.add("loader"),this.loader=this.domElement.appendChild(this.loader),this.error=document.createElement("div"),this.error.classList.add("error-msg"),this.error=this.domElement.appendChild(this.error),this.exportTimer=void 0,this.resizeTimer=void 0,this.notifyTimer=void 0,this.innerBehaviors=function(e){if(e){var t={grabber:e.grabber||yo.grabber,rendererList:e.rendererList||yo.rendererList,strokerList:e.strokerList||yo.strokerList,recognizerList:e.recognizerList||yo.recognizerList,events:e.events||yo.events,getBehaviorFromConfiguration:e.getBehaviorFromConfiguration||yo.getBehaviorFromConfiguration};return a.debug("Override default behaviors",t),t}return yo}(i),this.configuration=n,this.smartGuide=Bn(this),this.localTheme="",this.theme=o,this.penStyle=r,this.penStyleClasses="",this.domElement.editor=this}var n,r,o,i,s;return n=e,(r=[{key:"pointerDown",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"pen",n=arguments.length>2?arguments[2]:void 0;a.trace("Pointer down",e),window.clearTimeout(this.notifyTimer),window.clearTimeout(this.exportTimer),this.model=se(this.model,e,Object.assign({pointerType:t,pointerId:n},this.theme.ink,this.localPenStyle)),this.renderer.drawCurrentStroke(this.rendererContext,this.model,this.stroker)}},{key:"pointerMove",value:function(e){a.trace("Pointer move",e),this.model=ce(this.model,e),this.renderer.drawCurrentStroke(this.rendererContext,this.model,this.stroker)}},{key:"pointerUp",value:function(e){a.trace("Pointer up",e),this.model=le(this.model,e,this.penStyle),this.renderer.drawModel(this.rendererContext,this.model,this.stroker),this.recognizer.addStrokes?function(e,t){rr.apply(this,arguments)}(this,this.model):Er(this,this.model)}},{key:"removeStroke",value:function(e){this.model.strokeGroups.forEach((function(t){var n=t.strokes.map((function(e){return JSON.stringify(e)})).indexOf(JSON.stringify(e));-1!==n&&t.strokes.splice(n,1)}));var t=this.model.rawStrokes.map((function(e){return JSON.stringify(e)})).indexOf(JSON.stringify(e));-1!==t&&this.model.rawStrokes.splice(t,1),this.renderer.drawModel(this.rendererContext,this.model,this.stroker),Er(this,this.model),"DEMAND"!==this.configuration.triggers.exportContent&&ir(this,this.model)}},{key:"reDraw",value:function(e,t){var n=this;e.forEach((function(e){oe(n.model,e)})),t.forEach((function(e){e.strokes.forEach((function(t){ie(n.model,t,e.penStyle)}))})),this.renderer.drawModel(this.rendererContext,this.model,this.stroker),Er(this,this.model)}},{key:"waitForIdle",value:function(){return br(this,void 0,t.EventType.IDLE),function(e,t){return fr.apply(this,arguments)}(this,this.model)}},{key:"undo",value:(s=C(Jn.mark((function e(){var n,r,o,i=this;return Jn.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a.debug("Undo current model",this.model),br(this,void 0,t.EventType.UNDO),e.next=4,this.undoRedoManager.undo(this.undoRedoContext,this.model).catch((function(e){return wr(i,e)}));case 4:return n=e.sent,r=n.res,o=n.types,xr.apply(void 0,[this,r].concat(L(o))),e.abrupt("return",r);case 9:case"end":return e.stop()}}),e,this)}))),function(){return s.apply(this,arguments)})},{key:"redo",value:(i=C(Jn.mark((function e(){var n,r,o,i=this;return Jn.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a.debug("Redo current model",this.model),br(this,void 0,t.EventType.REDO),e.next=4,this.undoRedoManager.redo(this.undoRedoContext,this.model).catch((function(e){return wr(i,e)}));case 4:return n=e.sent,r=n.res,o=n.types,xr.apply(void 0,[this,r].concat(L(o))),e.abrupt("return",r);case 9:case"end":return e.stop()}}),e,this)}))),function(){return i.apply(this,arguments)})},{key:"clear",value:function(){var e=C(Jn.mark((function e(){var n,r,o,i=this;return Jn.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.canClear){e.next=10;break}return a.debug("Clear current model",this.model),br(this,void 0,t.EventType.CLEAR),e.next=5,this.recognizer.clear(this.recognizerContext,this.model).catch((function(e){return wr(i,e)}));case 5:return n=e.sent,r=n.res,o=n.events,Er.apply(void 0,[this,r].concat(L(o))),e.abrupt("return",r);case 10:return e.abrupt("return",Promise.reject(new Error("Cannot launch clear")));case 11:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"convert",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"DIGITAL_EDIT";return this.canConvert?(br(this,void 0,t.EventType.CONVERT),lr(this,this.model,e)):Promise.reject(new Error("Cannot launch convert"))}},{key:"setGuides",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return this.configuration.recognitionParams.iink.text.guides.enable=e,dr(this,this.model)}},{key:"export_",value:function(e){return this.canExport?(br(this,void 0,t.EventType.EXPORT),ir(this,this.model,e,t.Trigger.DEMAND)):Promise.reject(new Error("Cannot launch export"))}},{key:"import_",value:function(e,n){return br(this,void 0,t.EventType.IMPORT),function(e,t,n){return sr.apply(this,arguments)}(this,this.model,e instanceof Blob?e:new Blob([e],{type:n}))}},{key:"getSupportedImportMimeTypes",value:function(){return function(e,t){return cr.apply(this,arguments)}(this,this.model)}},{key:"pointerEvents",value:function(e){return function(e,t,n){return or.apply(this,arguments)}(this,this.model,e)}},{key:"resize",value:function(){return a.debug("Resizing editor"),this.renderer.resize(this.rendererContext,this.model,this.stroker,this.configuration.renderingParams.minHeight,this.configuration.renderingParams.minWidth),function(e,t){return hr.apply(this,arguments)}(this,this.model)}},{key:"setThemeForFont",value:function(e){var n=!Object.keys(t.Languages).includes(e),r="hy_AM"===e,o=n||r?t.Languages.default:t.Languages[e],i=n||r?"1.2":"1.8";this.theme={".text":{"font-family":o,"line-height":i}}}},{key:"unload",value:function(){this.grabber&&this.grabber.detach(this.domElement,this.grabberContext),this.innerRenderer&&this.innerRenderer.detach(this.domElement,this.rendererContext)}},{key:"forceChange",value:function(){br(this,void 0,t.EventType.CHANGED)}},{key:"configuration",set:function(e){this.loader.style.display="initial",this.error.style.display="none",this.innerConfiguration=function(e){var t,n=e;return n&&n.recognitionParams.server&&n.recognitionParams.server.useWindowLocation?(n.recognitionParams.server.scheme=window.location.protocol.slice(0,-1),n.recognitionParams.server.host=window.location.host,t=p({},h,void 0===n?{}:n)):t=p({},h,void 0===e?{}:e),a.debug("Override default configuration",t),t}(e),this.setThemeForFont(this.innerConfiguration.recognitionParams.iink.lang),this.behavior=this.behaviors.getBehaviorFromConfiguration(this.behaviors,this.innerConfiguration)},get:function(){return this.innerConfiguration}},{key:"penStyle",set:function(e){var t,n;this.innerPenStyle=(n=p({},void 0,void 0===(t=e)?{}:t),a.debug("Override default pen style",n),n),this.localPenStyle=this.innerPenStyle,function(e,t){gr.apply(this,arguments)}(this,this.model)},get:function(){return this.innerPenStyle}},{key:"penStyleClasses",set:function(e){this.innerPenStyleClasses=e,this.localPenStyle=this.theme[".".concat(this.innerPenStyleClasses)],function(e,t){mr.apply(this,arguments)}(this,this.model)},get:function(){return this.innerPenStyleClasses}},{key:"theme",set:function(e){this.innerTheme=function(e){var t=p({},y,void 0===e?{}:e);return a.debug("Override default theme",t),t}(e),function(e,t){return vr.apply(this,arguments)}(this,this.model).then((function(e){return console.log(e)})).catch((function(e){return console.error(e)}))},get:function(){return this.innerTheme}},{key:"behaviors",get:function(){return this.innerBehaviors}},{key:"behavior",set:function(e){e&&(this.grabber&&this.grabber.detach(this.domElement,this.grabberContext),this.innerBehavior=e,this.renderer=this.innerBehavior.renderer,this.recognizer=this.innerBehavior.recognizer,this.grabberContext=this.grabber.attach(this.domElement,this))},get:function(){return this.innerBehavior}},{key:"recognizer",set:function(e){var t=this;this.undoRedoContext={stack:[],currentPosition:-1,maxSize:this.configuration.undoRedoMaxStackSize,canUndo:!1,canRedo:!1},this.undoRedoManager=qn;var n=function(n){t.innerRecognizer=e,t.innerRecognizer&&(t.recognizerContext=qt(t),t.innerRecognizer.undo&&t.innerRecognizer.redo&&t.innerRecognizer.clear&&(t.undoRedoContext=t.recognizerContext,t.undoRedoManager=t.innerRecognizer),t.innerRecognizer.init(t.recognizerContext,n).then((function(e){a.info("Recognizer initialized !"),t.loader.style.display="none"})).catch((function(e){return wr(t,e)})))};e&&(this.innerRecognizer?this.innerRecognizer.close(this.recognizerContext,this.model).then((function(e){a.info("Recognizer closed"),Er(t,e),n(ne(e))})).catch((function(e){return wr(t,e)})):(this.model=te(this.configuration),n(this.model)))},get:function(){return this.innerRecognizer}},{key:"renderer",set:function(e){e&&(this.innerRenderer&&this.innerRenderer.detach(this.domElement,this.rendererContext),this.innerRenderer=e,this.innerRenderer&&(this.rendererContext=this.innerRenderer.attach(this.domElement,this.configuration.renderingParams.minHeight,this.configuration.renderingParams.minWidth)))},get:function(){return this.innerRenderer}},{key:"grabber",get:function(){return this.behavior?this.behavior.grabber:void 0}},{key:"stroker",get:function(){return this.behavior?this.behavior.stroker:void 0}},{key:"emit",get:function(){return this.behavior?this.behavior.events:void 0}},{key:"png",get:function(){return function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:10;if(e.rawStrokes.length>0){var r=ue(e),o=Zn(r,n),i=Zn(r,n),a={renderingCanvas:i,renderingCanvasContext:i.getContext("2d"),capturingCanvas:o,capturingCanvasContext:o.getContext("2d")};return a.renderingCanvasContext.translate(-r.minX+n,-r.minY+n),ke(a,e,t),a.renderingCanvas.toDataURL("image/png")}return null}(this.model,this.stroker)}},{key:"initialized",get:function(){return!!this.recognizerContext&&this.recognizerContext.initialized}},{key:"idle",get:function(){return this.recognizerContext.idle}},{key:"canUndo",get:function(){return this.undoRedoContext.canUndo}},{key:"canRedo",get:function(){return this.undoRedoContext.canRedo}},{key:"isEmpty",get:function(){return this.recognizerContext.isEmpty}},{key:"canClear",get:function(){return this.canUndo&&!this.isEmpty}},{key:"canConvert",get:function(){return!!(this.canUndo&&this.canClear&&this.recognizer&&this.recognizer.convert)}},{key:"possibleUndoCount",get:function(){return this.recognizerContext.possibleUndoCount}},{key:"undoStackIndex",get:function(){return this.recognizerContext.undoStackIndex}},{key:"canExport",get:function(){return this.canUndo&&this.canClear&&this.recognizer&&this.recognizer.getInfo().availableTriggers.exportContent.includes(t.Trigger.DEMAND)}},{key:"exports",get:function(){return this.model?this.model.exports:void 0}},{key:"supportedImportMimeTypes",get:function(){return this.recognizerContext.supportedImportMimeTypes}},{key:"eastereggs",get:function(){return $n}}])&&P(n.prototype,r),o&&P(n,o),e}();function br(e,n){for(var r=e,o=arguments.length,i=new Array(o>2?o-2:0),a=2;a<o;a++)i[a-2]=arguments[a];i.forEach((function(o){switch(o){case t.EventType.RENDERED:break;case t.EventType.UNDO:case t.EventType.REDO:case t.EventType.CLEAR:case t.EventType.CONVERT:case t.EventType.EXPORT:e.emit.call(e.domElement,o);break;case t.EventType.LOADED:case t.EventType.CHANGED:e.emit.call(e.domElement,o,{initialized:e.initialized,canUndo:e.canUndo,canRedo:e.canRedo,canClear:e.canClear,isEmpty:e.isEmpty,possibleUndoCount:e.possibleUndoCount,undoStackIndex:e.undoStackIndex,canConvert:e.canConvert,canExport:e.canExport});break;case t.EventType.EXPORTED:window.clearTimeout(r.notifyTimer),r.notifyTimer=window.setTimeout((function(){e.emit.call(e.domElement,o,{exports:e.exports})}),r.configuration.processDelay);break;case t.EventType.SUPPORTED_IMPORT_MIMETYPES:e.emit.call(e.domElement,o,{mimeTypes:e.supportedImportMimeTypes});break;case t.EventType.ERROR:e.emit.call(e.domElement,o,n);break;case t.EventType.IDLE:e.emit.call(e.domElement,o,{idle:e.idle});break;default:u.debug("No valid trigger configured for ".concat(o))}}))}function xr(e,n){for(var r=e,o=n,i=arguments.length,a=new Array(i>2?i-2:0),s=2;s<i;s++)a[s-2]=arguments[s];u.debug("model changed callback on ".concat(a," event(s)"),n),o.creationTime===e.model.creationTime&&(o.rawStrokes.length===e.model.rawStrokes.length&&o.lastPositions.lastSentPosition>=e.model.lastPositions.lastReceivedPosition?(r.model=ve(r.model,o),(re(r.model)||a.includes(t.EventType.RENDERED))&&e.renderer.drawModel(e.rendererContext,r.model,e.stroker)):(r.model=o,e.renderer.drawModel(e.rendererContext,r.model,e.stroker)),br.apply(void 0,[e,void 0].concat(a))),"TEXT"===e.configuration.recognitionParams.type&&"REST"!==e.configuration.recognitionParams.protocol&&e.configuration.recognitionParams.iink.text.mimeTypes.includes(t.Exports.JIIX)&&e.configuration.recognitionParams.iink.text.smartGuide&&(r.smartGuide=Fn(e.smartGuide,o.exports)),ae(n).length>0&&!e.recognizer.addStrokes&&e.configuration.triggers.exportContent!==t.Trigger.DEMAND&&ir(e,n)}function wr(e,n){var r=e;if("close"!==n.type&&u.error("Error while firing the recognition",n.stack||n),"Invalid application key."===n.message||"Invalid HMAC"===n.message||n.error&&n.error.result&&n.error.result.error&&("InvalidApplicationKeyException"===n.error.result.error||"InvalidHMACSignatureException"===n.error.result.error)||n.code&&"access.not.granted"===n.code?r.error.innerText=t.Error.WRONG_CREDENTIALS:"Session is too old. Max Session Duration Reached."===n.message||n.code&&"session.too.old"===n.code?r.error.innerText=t.Error.TOO_OLD:1006!==n.code&&1e3!==n.code||"none"!==r.error.style.display||(r.error.innerText=t.Error.NOT_REACHABLE),r.error.innerText!==t.Error.TOO_OLD&&"CLOSE_RECOGNIZER"!==n.reason||!en(e.recognizerContext)){r.loader.style.display="none",r.error.style.display="initial";for(var o=arguments.length,i=new Array(o>2?o-2:0),a=2;a<o;a++)i[a-2]=arguments[a];br.apply(void 0,[e,n,t.EventType.ERROR].concat(i))}else u.info("Reconnection is available",n.stack||n),r.error.style.display="none"}function Er(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),o=2;o<n;o++)r[o-2]=arguments[o];var i=e;e.undoRedoManager.updateModel?e.undoRedoManager.updateModel(e.undoRedoContext,t).then((function(e){var t=e.res,n=e.types;xr.apply(void 0,[i,t].concat(L([].concat(r,L(n)).filter((function(e,t,n){return t===n.indexOf(e)})))))})):("initial"===i.error.style.display&&(i.error.style.display="none"),xr.apply(void 0,[i,t].concat(r)))}function kr(e,n){var r=ne(n);u.debug("Updated model",r);var o=$t(e,r.lastPositions);return delete o.instanceId,u.debug("Updated recognizer context",o),Promise.resolve({err:void 0,res:r,events:[t.EventType.CHANGED,t.EventType.EXPORTED,t.EventType.RENDERED]})}var _r={types:[t.RecognitionType.TEXT,t.RecognitionType.DIAGRAM,t.RecognitionType.MATH,t.RecognitionType.RAWCONTENT],protocol:t.Protocol.REST,availableTriggers:{exportContent:[t.Trigger.QUIET_PERIOD,t.Trigger.DEMAND]}};function Sr(e,t,n,r){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"",i=arguments.length>5?arguments[5]:void 0,a=t.editor.configuration;return Vt(t,"".concat(a.recognitionParams.server.scheme,"://").concat(a.recognitionParams.server.host).concat(e),r(t,n,o),"V4",i).then((function(e){u.debug("iinkRestRecognizer success",e);var n=t.lastPositions;n.lastReceivedPosition=n.lastSentPosition;var r=$t(t,n);return e.instanceId&&(r.instanceId=e.instanceId),e}))}function Tr(e,t,n){var r,o=e.editor.configuration;"TEXT"===o.recognitionParams.type?r=function(e){return{text:e.recognitionParams.iink.text,lang:e.recognitionParams.iink.lang,export:e.recognitionParams.iink.export}}(o):"MATH"===o.recognitionParams.type?r=function(e){return{math:e.recognitionParams.iink.math,lang:e.recognitionParams.iink.lang,export:e.recognitionParams.iink.export}}(o):"DIAGRAM"===o.recognitionParams.type?r=function(e){return{diagram:e.recognitionParams.iink.diagram,lang:e.recognitionParams.iink.lang,export:e.recognitionParams.iink.export}}(o):"Raw Content"===o.recognitionParams.type&&(r=function(e){return{"raw-content":{recognition:e.recognitionParams.iink["raw-content"].recognition},lang:e.recognitionParams.iink.lang,export:e.recognitionParams.iink.export}}(o));var i=[];t.strokeGroups.forEach((function(e){var t={penStyle:"{}"===JSON.stringify(e.penStyle)?null:v(e.penStyle),strokes:e.strokes.map((function(e){return function(e){return{x:e.x,y:e.y,t:e.t}}(e)}))};i.push(t)}));var a={configuration:r,xDPI:96,yDPI:96,contentType:"Raw Content"===o.recognitionParams.type?"Raw Content":o.recognitionParams.type.charAt(0).toUpperCase()+o.recognitionParams.type.slice(1).toLowerCase(),theme:x(e.editor.theme),strokeGroups:i};return e.editor.domElement&&(a.height=e.editor.domElement.clientHeight,a.width=e.editor.domElement.clientWidth),n&&(a.conversionState="DIGITAL_EDIT"),de(t),a}function Cr(e,t,n){var r={};return r[t]=n,r}function Pr(e,n,r,o,i){u.debug("iinkRestRecognizer result callback",n);var a=pe(n);a.rawResults.exports=o,a.exports?Object.assign(a.exports,Cr(0,i,o)):a.exports=Cr(0,i,o),u.debug("iinkRestRecognizer model updated",a),e.editor.undoRedoManager&&Er(e.editor,a,t.EventType.EXPORTED,t.EventType.IDLE)}var Rr=Object.freeze({__proto__:null,iinkRestConfiguration:_r,getInfo:function(){return _r},postMessage:Sr,export_:function(e,t,n){var r=e.editor.configuration;function o(n){return Sr("/api/v4.0/iink/batch",e,t,Tr,r.restConversionState,n).then((function(r){return Pr(e,t,0,r,n),t})).catch((function(t){return wr(e.editor,t),t}))}return n?Promise.all(n.map((function(e){return o(e)}))):"TEXT"===r.recognitionParams.type?Promise.all(r.recognitionParams.iink.text.mimeTypes.map((function(e){return o(e)}))):"DIAGRAM"===r.recognitionParams.type?Promise.all(r.recognitionParams.iink.diagram.mimeTypes.map((function(e){return o(e)}))):"MATH"===r.recognitionParams.type?Promise.all(r.recognitionParams.iink.math.mimeTypes.map((function(e){return o(e)}))):"Raw Content"===r.recognitionParams.type?Promise.all(r.recognitionParams.iink["raw-content"].mimeTypes.map((function(e){return o(e)}))):Promise.reject(new Error("Export failed"))},convert:function(e,t){var n=e.editor.configuration;Sr("/api/v4.0/iink/batch",e,t,Tr,"DIGITAL_EDIT").then((function(e){return Pr(t,n)})).catch((function(t){return wr(e.editor,t)}))},init:function(e,n){var r=he(n);u.debug("Updated model",r);var o=$t(e,r.lastPositions);return o.initPromise=Promise.resolve(r),o.initPromise.then((function(e){return o.initialized=!0,u.debug("Updated recognizer context",o),Er(o.editor,e,t.EventType.LOADED),e}))},close:function(e,t){var n=e;return n.initialized=!1,delete n.instanceId,Promise.resolve(t)},clear:kr,reset:function(e,t){var n=he(t);u.debug("Updated model",n);var r=$t(e,n.lastPositions);return delete r.instanceId,u.debug("Updated recognizer context",r),Promise.resolve({res:n})}});function Lr(){}function Mr(e,t){return Math.floor(Math.random()*(t-e+1))+e}Lr.maxFromBits=function(e){return Math.pow(2,e)},Lr.limitUI04=Lr.maxFromBits(4),Lr.limitUI06=Lr.maxFromBits(6),Lr.limitUI08=Lr.maxFromBits(8),Lr.limitUI12=Lr.maxFromBits(12),Lr.limitUI14=Lr.maxFromBits(14),Lr.limitUI16=Lr.maxFromBits(16),Lr.limitUI32=Lr.maxFromBits(32),Lr.limitUI40=Lr.maxFromBits(40),Lr.limitUI48=Lr.maxFromBits(48),Lr.randomUI04=function(){return Mr(0,Lr.limitUI04-1)},Lr.randomUI06=function(){return Mr(0,Lr.limitUI06-1)},Lr.randomUI08=function(){return Mr(0,Lr.limitUI08-1)},Lr.randomUI12=function(){return Mr(0,Lr.limitUI12-1)},Lr.randomUI14=function(){return Mr(0,Lr.limitUI14-1)},Lr.randomUI16=function(){return Mr(0,Lr.limitUI16-1)},Lr.randomUI32=function(){return Mr(0,Lr.limitUI32-1)},Lr.randomUI40=function(){return(0|Math.random()*(1<<30))+(0|1024*Math.random())*(1<<30)},Lr.randomUI48=function(){return(0|Math.random()*(1<<30))+(0|Math.random()*(1<<18))*(1<<30)},Lr.paddedString=function(e,t,n){n=n||"0";for(var r=t-(e=String(e)).length;r>0;r>>>=1,n+=n)1&r&&(e=n+e);return e},Lr.prototype.fromParts=function(e,t,n,r,o,i){return this.version=n>>12&15,this.hex=Lr.paddedString(e.toString(16),8)+"-"+Lr.paddedString(t.toString(16),4)+"-"+Lr.paddedString(n.toString(16),4)+"-"+Lr.paddedString(r.toString(16),2)+Lr.paddedString(o.toString(16),2)+"-"+Lr.paddedString(i.toString(16),12),this},Lr.prototype.toString=function(){return this.hex},Lr.prototype.toURN=function(){return"urn:uuid:"+this.hex},Lr.prototype.toBytes=function(){for(var e=this.hex.split("-"),t=[],n=0,r=0;r<e.length;r++)for(var o=0;o<e[r].length;o+=2)t[n++]=parseInt(e[r].substr(o,2),16);return t},Lr.prototype.equals=function(e){return e instanceof UUID&&this.hex===e.hex},Lr.getTimeFieldValues=function(e){var t=e-Date.UTC(1582,9,15),n=t/4294967296*1e4&268435455;return{low:1e4*(268435455&t)%4294967296,mid:65535&n,hi:n>>>16,timestamp:t}},Lr._create4=function(){return(new Lr).fromParts(Lr.randomUI32(),Lr.randomUI16(),16384|Lr.randomUI12(),128|Lr.randomUI06(),Lr.randomUI08(),Lr.randomUI48())},Lr._create1=function(){var e=(new Date).getTime(),t=Lr.randomUI14(),n=1099511627776*(1|Lr.randomUI08())+Lr.randomUI40(),r=Lr.randomUI04(),o=0;e!=o?(e<o&&t++,o=e,r=Lr.randomUI04()):Math.random()<1/4&&r<9984?r+=1+Lr.randomUI04():t++;var i=Lr.getTimeFieldValues(o),a=i.low+r,s=4095&i.hi|4096,c=(t&=16383)>>>8|128,l=255&t;return(new Lr).fromParts(a,i.mid,s,c,l,n)},Lr.create=function(e){return this["_create"+(e=e||4)]()},Lr.fromTime=function(e,t){t=t||!1;var n=Lr.getTimeFieldValues(e),r=n.low,o=4095&n.hi|4096;return!1===t?(new Lr).fromParts(r,n.mid,o,0,0,0):(new Lr).fromParts(r,n.mid,o,128|Lr.limitUI06,Lr.limitUI08-1,Lr.limitUI48-1)},Lr.firstFromTime=function(e){return Lr.fromTime(e,!1)},Lr.lastFromTime=function(e){return Lr.fromTime(e,!0)},Lr.fromURN=function(e){var t;return(t=/^(?:urn:uuid:|\{)?([0-9a-f]{8})-([0-9a-f]{4})-([0-9a-f]{4})-([0-9a-f]{2})([0-9a-f]{2})-([0-9a-f]{12})(?:\})?$/i.exec(e))?(new Lr).fromParts(parseInt(t[1],16),parseInt(t[2],16),parseInt(t[3],16),parseInt(t[4],16),parseInt(t[5],16),parseInt(t[6],16)):null},Lr.fromBytes=function(e){if(e.length<5)return null;for(var t="",n=0,r=[4,2,2,2,6],o=0;o<r.length;o++){for(var i=0;i<r[o];i++){var a=e[n++].toString(16);1==a.length&&(a="0"+a),t+=a}6!==r[o]&&(t+="-")}return Lr.fromURN(t)},Lr.fromBinary=function(e){for(var t=[],n=0;n<e.length;n++)if(t[n]=e.charCodeAt(n),t[n]>255||t[n]<0)throw new Error("Unexpected byte in binary data.");return Lr.fromBytes(t)},Lr.new=function(){return this.create(4)},Lr.newTS=function(){return this.create(1)};var Ir=Lr;function Ar(e){var t;try{t=new WebSocket(e.url)}catch(e){u.error("Unable to open websocket, Check the host and your connectivity")}return function(e,t){var n=t.editor.configuration.recognitionParams.server.websocket,r=e;r.start=new Date,r.autoReconnect=n.autoReconnect,r.maxRetryCount=n.maxRetryCount,r.pingEnabled=n.pingEnabled,r.pingDelay=n.pingDelay,r.maxPingLost=n.maxPingLostCount,r.pingLostCount=0,r.recognizerContext=t}(t,e),t.pingEnabled&&function e(t){var n=t;n.pingLostCount++,n.pingLostCount>n.maxPingLost?t.close(1e3,"PING_LOST"):n.readyState<=1&&setTimeout((function(){n.readyState<=1&&(n.send(JSON.stringify({type:"ping"})),e(n))}),n.pingDelay)}(t),t.onopen=function(t){u.trace("onOpen"),e.websocketCallback(t)},t.onclose=function(n){u.trace("onClose",new Date-t.start),e.websocketCallback(n)},t.onerror=function(t){u.trace("onError"),e.websocketCallback(t)},t.onmessage=function(n){if(u.trace("onMessage"),t.pingLostCount=0,"pong"!==JSON.parse(n.data).type){var r={type:n.type,data:JSON.parse(n.data)};e.websocketCallback(r)}},t}function Or(e,t){var n=e;n.idle=!1;var r=n.websocket;if(!(r.readyState<=1))throw nn;r.send(JSON.stringify(t)),u.debug("".concat(t.type," message sent"),t)}function zr(e){return function(t){var n=e;u.trace("".concat(t.type," websocket callback"),t);var r=e.recognitionContexts[e.recognitionContexts.length-1];switch(u.debug("Current recognition context",r),t.type){case"open":e.sessionId?Or(e,Yr(e.editor.configuration,e.editor.domElement,e.sessionId)):Or(e,Wr(e.editor.configuration,e.editor.domElement));break;case"message":switch(u.debug("Receiving ".concat(t.data.type," message"),t),t.data.type){case"ack":t.data.hmacChallenge&&Or(e,function(e,t){return{type:"hmac",hmac:Jt(t.data.hmacChallenge,e.recognitionParams.server.applicationKey,e.recognitionParams.server.hmacKey)}}(e.editor.configuration,t)),t.data.iinkSessionId&&(n.sessionId=t.data.iinkSessionId);break;case"newPart":break;case"contentPackageDescription":n.currentReconnectionCount=0,n.contentPartCount=t.data.contentPartCount,Or(e,Fr(e.editor.configuration)),n.currentPartId?Or(e,Gr(e.editor.configuration,e.currentPartId)):Or(e,Br(e.editor.configuration));break;case"partChanged":t.data.partId&&(n.currentPartId=t.data.partId),n.initialized=!0,Or(e,co(e.editor.theme)),Or(e,ao(e.editor.penStyle)),Or(e,so(e.editor.penStyleClasses)),r.partChange.resolve([void 0,t.data]);break;case"contentChanged":void 0!==t.data.canUndo&&(n.canUndo=t.data.canUndo),void 0!==t.data.canRedo&&(n.canRedo=t.data.canRedo),void 0!==t.data.empty&&(n.isEmpty=t.data.empty),void 0!==t.data.possibleUndoCount&&(n.possibleUndoCount=t.data.possibleUndoCount),void 0!==t.data.undoStackIndex&&(n.undoStackIndex=t.data.undoStackIndex),r.contentChange.resolve([void 0,t.data]);break;case"exported":r.response.resolve([void 0,t.data]);break;case"svgPatch":r.patch(void 0,t.data);break;case"supportedImportMimeTypes":n.supportedImportMimeTypes=t.data.mimeTypes,r.response.resolve([void 0,t.data]);break;case"fileChunkAck":r.response.resolve([void 0,t.data]);break;case"idle":n.idle=!0,r.response.resolve([void 0,t.data]);break;case"error":u.debug("Error detected stopping all recognition",t),r?r.patch(t.data):r.initPromise.reject(Object.assign({},t.data,{recoverable:!1}));break;default:u.warn("This is something unexpected in current recognizer. Not the type of message we should have here.",t)}break;case"error":u.debug("Error detected stopping all recognition",t),r?r.initPromise.resolve(Object.assign({},t,{recoverable:!1})):r.initPromise.reject(Object.assign({},t,{recoverable:!1}));break;case"close":u.debug("Close detected stopping all recognition",t),n.initialized=!1,n.canRedo=!1,n.canUndo=!1,r?r.initPromise.resolve(t):r.initPromise.reject(t);break;default:u.warn("This is something unexpected in current recognizer. Not the type of message we should have here.",t)}}}function Nr(e,t,n,r){var o=t.recognitionContexts[0],i=$t(t,o.model.lastPositions);return i.url=function(e,t){var n="https"===e.recognitionParams.server.scheme?"wss":"ws";return"".concat(n,"://").concat(e.recognitionParams.server.host).concat(t)}(t.editor.configuration,e),i.reconnect=r,i.initPromise=o.initPromise.promise,u.debug("Opening the websocket for context ",t),i.websocketCallback=n(i),i.websocket=Ar(i),i.initPromise}function Dr(e,t,n,r){for(var o=arguments.length,i=new Array(o>4?o-4:0),a=4;a<o;a++)i[a-4]=arguments[a];if(!tn(t)||!t.reconnect)throw new Error("Unable to reconnect ".concat(n));u.info("Attempting a retry",t.currentReconnectionCount),t.reconnect(t,n,(function(o,a){o?(u.error("Failed retry",o),Dr.apply(void 0,[e,t,n,r].concat(i))):e.apply(void 0,[t,a,r].concat(i))}))}function jr(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),o=2;o<n;o++)r[o-2]=arguments[o];return e.initPromise.then((function(){u.trace("Init was done. Sending message");var n=t.apply(void 0,r);if(n){Or(e,n);var o=e.recognitionContexts[0].model.lastPositions;o&&$t(e,o)}else u.warn("empty message")}))}function Hr(e,t){var n={model:t,initPromise:Qn()},r=e;return e.initPromise.then((function(){return r.recognitionContexts[0]=n,r})).then((function(e){return function(e,t,n){var r=e.websocket;r&&r.readyState<2&&r.close(t,n)}(e,1e3,"CLOSE_RECOGNIZER"),n.model}))}var Xr=Object.freeze({__proto__:null,init:Nr,retry:Dr,sendMessage:jr,clear:function(e,t,n){var r=ne(t),o=$t(e,r.lastPositions);if(o&&o.websocket){delete o.instanceId;try{Or(o,{type:"reset"})}catch(e){o.websocketCallback(Qn(),o,t)}}n(void 0,r)},close:Hr});var Ur={types:[t.RecognitionType.MATH,t.RecognitionType.TEXT,t.RecognitionType.DIAGRAM,t.RecognitionType.NEBO],protocol:t.Protocol.WEBSOCKET,availableTriggers:{exportContent:[t.Trigger.POINTER_UP,t.Trigger.DEMAND],addStrokes:[t.Trigger.POINTER_UP]}};function Wr(e,t){return{type:"newContentPackage",applicationKey:e.recognitionParams.server.applicationKey,xDpi:96,yDpi:96,viewSizeHeight:t.clientHeight<e.renderingParams.minHeight?e.renderingParams.minHeight:t.clientHeight,viewSizeWidth:t.clientWidth<e.renderingParams.minWidth?e.renderingParams.minWidth:t.clientWidth}}function Yr(e,t,n){return{type:"restoreIInkSession",iinkSessionId:n,applicationKey:e.recognitionParams.server.applicationKey,xDpi:96,yDpi:96,viewSizeHeight:t.clientHeight<e.renderingParams.minHeight?e.renderingParams.minHeight:t.clientHeight,viewSizeWidth:t.clientWidth<e.renderingParams.minWidth?e.renderingParams.minWidth:t.clientWidth}}function Br(e){return{type:"newContentPart",contentType:e.recognitionParams.type,mimeTypes:e.triggers.exportContent!==t.Trigger.DEMAND?e.recognitionParams.iink["".concat(e.recognitionParams.type.toLowerCase())].mimeTypes:void 0}}function Gr(e,n){return{type:"openContentPart",id:n,mimeTypes:e.triggers.exportContent!==t.Trigger.DEMAND?e.recognitionParams.iink["".concat(e.recognitionParams.type.toLowerCase())].mimeTypes:void 0}}function Fr(e){return Object.assign({type:"configuration"},e.recognitionParams.iink)}function Jr(e,t){var n=ae(t,e.lastPositions.lastSentPosition+1);if(n.length>0)return de(t),{type:"addStrokes",strokes:n.map((function(e){return Object.assign({},{id:e.id,pointerType:e.pointerType,pointerId:e.pointerId,x:e.x,y:e.y,t:e.t,p:e.p})}))}}function Kr(){return{type:"undo"}}function Vr(){return{type:"redo"}}function qr(){return{type:"clear"}}function Zr(e){return{type:"convert",conversionState:e}}function $r(e){return{type:"zoom",zoom:e}}function Qr(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return{type:"changeViewSize",height:e.clientHeight<t?t:e.clientHeight,width:e.clientWidth<n?n:e.clientWidth}}function eo(e,t,n){return{type:"export",partId:t,mimeTypes:n&&0!==Object.keys(n).length?n:e.recognitionParams.iink["".concat(e.recognitionParams.type.toLowerCase())].mimeTypes}}function to(e,t){return{type:"importFile",importFileId:e,mimeType:t}}function no(e,t,n){return{type:"fileChunk",importFileId:e,data:t,lastChunk:n}}function ro(e){return Object.assign({type:"pointerEvents"},e)}function oo(){return{type:"waitForIdle"}}function io(){return{type:"getSupportedImportMimeTypes"}}function ao(e){return{type:"setPenStyle",style:e?v(e):""}}function so(e){return{type:"setPenStyleClasses",styleClasses:e}}function co(e){return{type:"setTheme",theme:x(e)}}var lo=function(e,n,r,o){var i=pe(e);if(r){var a="";return void 0!==r.updates&&(i.recognizedSymbols?i.recognizedSymbols.push(r):i.recognizedSymbols=[r],a=t.EventType.RENDERED),void 0!==r.exports&&(i.rawResults.exports=r,i.exports=r.exports,a=t.EventType.EXPORTED),void 0===r.canUndo&&void 0===r.canRedo||(a=t.EventType.CHANGED),"supportedImportMimeTypes"===r.type&&(a=t.EventType.SUPPORTED_IMPORT_MIMETYPES),"partChanged"===r.type&&(a=t.EventType.LOADED),"idle"===r.type&&(a=t.EventType.IDLE),"close"===r.type&&(a=t.EventType.CHANGED),Er(o.editor,e,a)}return wr(o.editor,n)};function uo(e,t){return po.apply(this,arguments)}function po(){return(po=C(Jn.mark((function e(t,n){var r,o,i,a,s,c,l,d,p,h,f,g,m;return Jn.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=Qn(),o=Qn(),i=Qn(),s=null,"MATH"===t.editor.innerConfiguration.recognitionParams.type||"DIAGRAM"===t.editor.innerConfiguration.recognitionParams.type?a=Qt(t,{model:de(n,n.lastPositions.lastReceivedPosition),partChange:o,initPromise:i,patch:function(e,t){return lo(n,e,t,a)}}):(a=Qt(t,{model:de(n,n.lastPositions.lastReceivedPosition),contentChange:r,partChange:o,initPromise:i,patch:function(e,t){return lo(n,e,t,a)}}),s=a.recognitionContexts[0].contentChange.promise),Nr("/api/v4.0/iink/document",a,zr,uo).catch((function(e){tn(t)&&t.reconnect?(u.info("Attempting a reconnect",t.currentReconnectionCount),t.reconnect(t,n)):(u.error("Unable to reconnect",e),lo(n,e,void 0,t))})),e.next=8,a.recognitionContexts[0].partChange.promise;case 8:if(c=e.sent,l=R(c,2),d=l[0],!(p=l[1])){e.next=23;break}if(lo(n,d,p,t),null===s){e.next=22;break}return e.next=17,s;case 17:h=e.sent,f=R(h,2),g=f[0],(m=f[1])&&lo(n,g,m,t);case 22:a.recognitionContexts[0].initPromise.resolve(!0);case 23:return e.abrupt("return",a.recognitionContexts[0].initPromise);case 24:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ho(e,t,n){return fo.apply(this,arguments)}function fo(){return(fo=C(Jn.mark((function e(t,n,r){var o,i,a,s,c,l,d,p,h=arguments;return Jn.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(o=h.length,i=new Array(o>3?o-3:0),a=3;a<o;a++)i[a-3]=h[a];return u.info("-- Prepare message for ".concat(r.name," --")),s=Qn(),c=Qn(),l=Qt(t,{model:n,response:s,contentChange:c,patch:function(e,t){return lo(n,e,t,l)}}),jr.apply(Xr,[l,r].concat(i)).catch((function(e){u.error(e),Dr.apply(Xr,[ho,t,n,r].concat(i))})),e.next=8,l.recognitionContexts[0].response.promise;case 8:return(d=e.sent)&&lo(n,d[0],d[1],l),e.next=12,l.recognitionContexts[0].contentChange.promise;case 12:if(!(p=e.sent)){e.next=16;break}return lo(n,p[0],p[1],l),e.abrupt("return",{res:n,types:[]});case 16:return e.abrupt("return",null);case 17:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function go(e,t){return mo.apply(this,arguments)}function mo(){return(mo=C(Jn.mark((function e(t,n){var r,o,i,a,s;return Jn.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=Qn(),o=Qn(),jr(i=Qt(t,{model:n,response:r,contentChange:o,patch:function(){var e=C(Jn.mark((function e(r,o){var a,s,c;return Jn.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,kr(t,n);case 2:a=e.sent,s=a.err,c=a.res,lo(c,s,o,i);case 6:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()}),qr).catch((function(e){return Dr(go,t,n)})),e.next=6,i.recognitionContexts[0].response.promise;case 6:return a=e.sent,e.next=9,i.recognitionContexts[0].contentChange.promise;case 9:if(s=e.sent,a&&lo(n,a[0],a[1],i),!s){e.next=14;break}return lo(n,s[0],s[1],i),e.abrupt("return",{err:void 0,res:i.recognitionContexts[0].model,events:[]});case 14:return e.abrupt("return",null);case 15:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var vo=Object.freeze({__proto__:null,IinkWsConfiguration:Ur,getInfo:function(){return Ur},buildNewContentPackageInput:Wr,buildRestoreIInkSessionInput:Yr,buildNewContentPart:Br,buildOpenContentPart:Gr,buildConfiguration:Fr,buildSetPenStyle:ao,buildSetPenStyleClasses:so,buildSetTheme:co,init:uo,newContentPart:function(e,t){return ho(e,t,Br,e.editor.configuration)},openContentPart:function(e,t){return ho(e,t,Gr,[e.editor.configuration,e.currentPartId])},sendConfiguration:function(e,t){return ho(e,t,Fr,e.editor.configuration)},pointerEvents:function(e,t,n){return ho(e,t,ro,n)},addStrokes:function(e,t){var n=[e,t];return ho.apply(void 0,[e,t,Jr].concat(n))},undo:function(e,t){return ho(e,t,Kr)},redo:function(e,t){return ho(e,t,Vr)},clear:go,convert:function(e,t,n){return ho(e,t,Zr,n)},export_:function(e,t,n){var r=[e.editor.configuration,e.currentPartId,n];return ho.apply(void 0,[e,t,eo].concat(r))},import_:function(e,t,n){for(var r={model:t,response:function(n,r){return lo(t,n,r,e)},importFileId:Ir.create(4).toString()},o=Qt(e,r),i=e.editor.configuration.recognitionParams.server.websocket.fileChunkSize,a=[],s=function(e){0===e&&a.push(ho(o,t,to,r.importFileId,n.type)),function(e){var t=this,n=new FileReader;return new Promise((function(r,o){n.onload=function(e){return r(e.target.result)},n.onerror=function(){return o(new Error(t))},n.readAsText(e)}))}(n.slice(e,i,n.type)).then((function(s){var c=[r.importFileId,s,e+i>n.size];a.push(ho.apply(void 0,[o,t,no].concat(c)))}))},c=0;c<n.size;c+=i)s(c);return Promise.all(a)},getSupportedImportMimeTypes:function(e,t){return ho(e,t,io)},waitForIdle:function(e,t){return ho(e,t,oo)},resize:function(e,t,n){var r=[n,e.editor.configuration.renderingParams.minHeight,e.editor.configuration.renderingParams.minWidth];return ho.apply(void 0,[e,t,Qr].concat(r))},zoom:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:10;return ho(e,t,$r,n)},setPenStyle:function(e,t,n){return ho(e,t,ao,n)},setPenStyleClasses:function(e,t,n){return ho(e,t,so,n)},setTheme:function(e,t,n){return ho(e,t,co,n)},close:Hr});var yo={grabber:_,strokerList:[Me,Yt],rendererList:[_e,Ht],recognizerList:[Rr,vo],events:function(e,t){d.info("emitting ".concat(e," event"),t),this.dispatchEvent(new CustomEvent(e,Object.assign({bubbles:!0,composed:!0},t?{detail:t}:void 0)))},getBehaviorFromConfiguration:function(e,t){var n={};return n.grabber=e.grabber,t&&("REST"===t.recognitionParams.protocol?(n.stroker=Me,n.renderer=_e,n.recognizer=Rr):(n.stroker=Yt,n.renderer=Ht,n.recognizer=vo)),n.events=e.events,n}};var bo={af_ZA:"Afrikaans",az_AZ:"Azrbaycanca",be_BY:"",bg_BG:"",bs_BA:"Bosanski",ca_ES:"Catal",ceb_PH:"Sinugboanon",cs_CZ:"etina",da_DK:"Dansk",de_AT:"Deutsch (sterreich)",de_DE:"Deutsch",el_GR:"",en_CA:"English (Canada)",en_GB:"English (United Kingdom)",en_PH:"English (Philippines)",en_US:"English (United States)",es_CO:"Espaol (Colombia)",es_ES:"Espaol (Espaa)",es_MX:"Espaol (Mxico)",et_EE:"Eesti",eu_ES:"Euskara",fi_FI:"Suomi",fil_PH:"Filipino",fr_CA:"Franais (Canada)",fr_FR:"Franais (France)",ga_IE:"Gaeilge",gl_ES:"Galego",hr_HR:"Hrvatski",hu_HU:"Magyar",hy_AM:"",id_ID:"Bahasa Indonesia",is_IS:"slenska",it_IT:"Italiano",ja_JP:"",ka_GE:"",kk_KZ:"",ko_KR:"",lt_LT:"Lietuvi",lv_LV:"Latvieu",mg_MG:"Malagasy",mk_MK:"",mn_MN:"",ms_MY:"Bahasa Melayu (Malaysia)",nl_BE:"Nederlands (Belgi)",nl_NL:"Nederlands",no_NO:"Norsk (Bokml)",pl_PL:"Polski",pt_BR:"Portugus (Brasil)",pt_PT:"Portugus (Portugal)",ro_RO:"Romn",ru_RU:"",sk_SK:"Slovenina",sl_SI:"Slovenina",sq_AL:"Shqip",sr_Cyrl_RS:"",sr_Latn_RS:"Srpski",sv_SE:"Svenska",sw_TZ:"Kiswahili",tr_TR:"Trke",tt_RU:"",uk_UA:"",vi_VN:"Ting Vit",zh_CN:" ()",zh_HK:" ()",zh_TW:" ()"},xo={result:bo},wo=Object.freeze({__proto__:null,result:bo,default:xo});function Eo(e,t,n,r,o){return a.debug("Registering a new editor"),new yr(e,t,n,r,o)}function ko(e){return wo}var _o={Constants:t,DefaultConfiguration:h,DefaultBehaviors:yo,DefaultPenStyle:void 0,DefaultTheme:y,register:Eo,getAvailableLanguageList:ko,LoggerConfig:i,Editor:yr,InkModel:ye,RecognizerContext:rn};e.Constants=t,e.DefaultBehaviors=yo,e.DefaultConfiguration=h,e.DefaultPenStyle=void 0,e.DefaultTheme=y,e.Editor=yr,e.InkModel=ye,e.LoggerConfig=i,e.RecognizerContext=rn,e.default=_o,e.getAvailableLanguageList=ko,e.register=Eo,Object.defineProperty(e,"__esModule",{value:!0})}));
//# sourceMappingURL=iink.min.js.map
